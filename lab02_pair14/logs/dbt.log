[0m14:33:31.816127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB0F268AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB10020690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB10187C50>]}


============================== 14:33:31.820895 | d7eec4de-5d9b-460e-aade-219478472a54 ==============================
[0m14:33:31.820895 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:33:31.821612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init lab02_pair14', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:31.847981 [info ] [MainThread]: Setting up your profile.
[0m14:33:53.625038 [debug] [MainThread]: Command `dbt init` succeeded at 14:33:53.624860 after 22.02 seconds
[0m14:33:53.625440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB101B22C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB1020F0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB1003D9D0>]}
[0m14:33:53.625797 [debug] [MainThread]: Flushing usage events
[0m14:33:54.069505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:17.466431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA771DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA53C6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA81A6210>]}


============================== 14:35:17.471062 | 779a6022-849a-429f-aa02-b74a5f51ae8d ==============================
[0m14:35:17.471062 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:35:17.471669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:35:18.233402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '779a6022-849a-429f-aa02-b74a5f51ae8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAA3E42B0>]}
[0m14:35:18.292430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '779a6022-849a-429f-aa02-b74a5f51ae8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAA2C49E0>]}
[0m14:35:18.293944 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:35:18.700472 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:35:18.701350 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:35:18.701814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '779a6022-849a-429f-aa02-b74a5f51ae8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAA1C3B50>]}
[0m14:35:18.732878 [error] [MainThread]: Encountered an error:
'NoneType' object is not iterable
[0m14:35:18.753456 [error] [MainThread]: Traceback (most recent call last):
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ~~~~~~~~~~~~~~^
        runtime_config, write_perf_info, write, ctx.obj["flags"].write_json
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\manifest.py", line 2069, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
        runtime_config,
        write_perf_info=write_perf_info,
    )
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\manifest.py", line 312, in get_full_manifest
    manifest = loader.load()
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\manifest.py", line 359, in load
    file_reader.read_files()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\read_files.py", line 212, in read_files
    self.read_files_for_project(project, file_types)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\read_files.py", line 219, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ~~~~~~~~~~~~~~~~~~~~~^
        project,
        ^^^^^^^^
    ...<4 lines>...
        dbt_ignore_spec,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\read_files.py", line 167, in read_files_for_parser
    source_files = get_source_files(
        project, dirs, extension, parse_ft, saved_files, ignore_spec
    )
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\read_files.py", line 156, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\read_files.py", line 89, in load_source_file
    dfy = yaml_from_file(source_file)
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\schemas.py", line 125, in yaml_from_file
    for table in source.get("tables", []):
                 ~~~~~~~~~~^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not iterable

[0m14:35:18.758301 [debug] [MainThread]: Command `dbt test` failed at 14:35:18.758093 after 1.52 seconds
[0m14:35:18.758794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAA508410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFAA5089B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CFA8503E70>]}
[0m14:35:18.759271 [debug] [MainThread]: Flushing usage events
[0m14:35:19.160865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:33.630203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDBCFA9BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDBAC92350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDBDA36210>]}


============================== 15:27:33.635461 | 9ea1d58b-2d66-4cd3-97f1-7c89a1161cd6 ==============================
[0m15:27:33.635461 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:27:33.636071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:27:33.660265 [info ] [MainThread]: dbt version: 1.9.4
[0m15:27:33.660722 [info ] [MainThread]: python version: 3.13.1
[0m15:27:33.661114 [info ] [MainThread]: python path: F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Scripts\python.exe
[0m15:27:33.661480 [info ] [MainThread]: os info: Windows-11-10.0.22000-SP0
[0m15:27:33.983010 [info ] [MainThread]: Using profiles dir at C:\Users\pjdam\.dbt
[0m15:27:33.983514 [info ] [MainThread]: Using profiles.yml file at C:\Users\pjdam\.dbt\profiles.yml
[0m15:27:33.983903 [info ] [MainThread]: Using dbt_project.yml file at F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\dbt_project.yml
[0m15:27:33.985063 [info ] [MainThread]: adapter type: snowflake
[0m15:27:33.985449 [info ] [MainThread]: adapter version: 1.9.2
[0m15:27:34.076190 [info ] [MainThread]: Configuration:
[0m15:27:34.076733 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:27:34.077168 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:27:34.077622 [info ] [MainThread]: Required dependencies:
[0m15:27:34.078126 [debug] [MainThread]: Executing "git --help"
[0m15:27:34.109263 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:27:34.109842 [debug] [MainThread]: STDERR: "b''"
[0m15:27:34.110192 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:27:34.110629 [info ] [MainThread]: Connection:
[0m15:27:34.111019 [info ] [MainThread]:   account: sfedu02-ksb65579
[0m15:27:34.111421 [info ] [MainThread]:   user: BOA
[0m15:27:34.111900 [info ] [MainThread]:   database: USER_DB_BOA
[0m15:27:34.112359 [info ] [MainThread]:   warehouse: BOA_QUERY_WH
[0m15:27:34.112840 [info ] [MainThread]:   role: TRAINING_ROLE
[0m15:27:34.113231 [info ] [MainThread]:   schema: analytics
[0m15:27:34.113767 [info ] [MainThread]:   authenticator: None
[0m15:27:34.114180 [info ] [MainThread]:   oauth_client_id: None
[0m15:27:34.114611 [info ] [MainThread]:   query_tag: None
[0m15:27:34.115040 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:27:34.115452 [info ] [MainThread]:   host: None
[0m15:27:34.115857 [info ] [MainThread]:   port: None
[0m15:27:34.116239 [info ] [MainThread]:   proxy_host: None
[0m15:27:34.116631 [info ] [MainThread]:   proxy_port: None
[0m15:27:34.117000 [info ] [MainThread]:   protocol: None
[0m15:27:34.117359 [info ] [MainThread]:   connect_retries: 1
[0m15:27:34.117708 [info ] [MainThread]:   connect_timeout: None
[0m15:27:34.118064 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:27:34.118411 [info ] [MainThread]:   retry_all: False
[0m15:27:34.118758 [info ] [MainThread]:   insecure_mode: False
[0m15:27:34.119102 [info ] [MainThread]:   reuse_connections: True
[0m15:27:34.119682 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:27:34.404299 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:27:36.481013 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:27:36.481473 [debug] [MainThread]: On debug: select 1 as id
[0m15:27:36.481728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:27:37.710844 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.229 seconds
[0m15:27:37.711671 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:27:37.712400 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:27:37.713412 [debug] [MainThread]: Command `dbt debug` succeeded at 15:27:37.713300 after 4.32 seconds
[0m15:27:37.713688 [debug] [MainThread]: Connection 'debug' was left open.
[0m15:27:37.713981 [debug] [MainThread]: On debug: Close
[0m15:27:37.863675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDBFCFB360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDBFD73AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDBFB879B0>]}
[0m15:27:37.864090 [debug] [MainThread]: Flushing usage events
[0m15:27:38.308455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:39:00.924107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027086C39BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027084922350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270876C6210>]}


============================== 15:39:00.928054 | fd91a22d-ca2c-4898-980e-d22e5a919228 ==============================
[0m15:39:00.928054 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:39:00.928679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:39:01.328494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd91a22d-ca2c-4898-980e-d22e5a919228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270899642B0>]}
[0m15:39:01.383361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd91a22d-ca2c-4898-980e-d22e5a919228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270898449E0>]}
[0m15:39:01.384674 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:39:01.658773 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:39:01.659886 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:39:01.660601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd91a22d-ca2c-4898-980e-d22e5a919228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027089743B50>]}
[0m15:39:01.670112 [error] [MainThread]: Encountered an error:
'NoneType' object is not iterable
[0m15:39:01.675791 [error] [MainThread]: Traceback (most recent call last):
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ~~~~~~~~~~~~~~^
        runtime_config, write_perf_info, write, ctx.obj["flags"].write_json
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\manifest.py", line 2069, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
        runtime_config,
        write_perf_info=write_perf_info,
    )
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\manifest.py", line 312, in get_full_manifest
    manifest = loader.load()
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\manifest.py", line 359, in load
    file_reader.read_files()
    ~~~~~~~~~~~~~~~~~~~~~~^^
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\read_files.py", line 212, in read_files
    self.read_files_for_project(project, file_types)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\read_files.py", line 219, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ~~~~~~~~~~~~~~~~~~~~~^
        project,
        ^^^^^^^^
    ...<4 lines>...
        dbt_ignore_spec,
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\read_files.py", line 167, in read_files_for_parser
    source_files = get_source_files(
        project, dirs, extension, parse_ft, saved_files, ignore_spec
    )
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\read_files.py", line 156, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\read_files.py", line 89, in load_source_file
    dfy = yaml_from_file(source_file)
  File "F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Lib\site-packages\dbt\parser\schemas.py", line 125, in yaml_from_file
    for table in source.get("tables", []):
                 ~~~~~~~~~~^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not iterable

[0m15:39:01.679413 [debug] [MainThread]: Command `dbt run` failed at 15:39:01.679192 after 0.98 seconds
[0m15:39:01.679797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027089A88410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027089A889B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027087A23E70>]}
[0m15:39:01.680157 [debug] [MainThread]: Flushing usage events
[0m15:39:02.075253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:58.468824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C5CB9BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C3966350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C6746210>]}


============================== 18:05:58.487997 | 34e10390-4a6b-4301-8702-aa8ca07c1aec ==============================
[0m18:05:58.487997 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:05:58.491552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:05:59.648048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34e10390-4a6b-4301-8702-aa8ca07c1aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C89C42B0>]}
[0m18:05:59.718877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34e10390-4a6b-4301-8702-aa8ca07c1aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C88949E0>]}
[0m18:05:59.720477 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:06:00.138862 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:06:00.140268 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:06:00.140987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '34e10390-4a6b-4301-8702-aa8ca07c1aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C87A3B50>]}
[0m18:06:02.971235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34e10390-4a6b-4301-8702-aa8ca07c1aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C8AE9040>]}
[0m18:06:03.037147 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m18:06:03.061272 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m18:06:03.102224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34e10390-4a6b-4301-8702-aa8ca07c1aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C8D573F0>]}
[0m18:06:03.102771 [info ] [MainThread]: Found 2 models, 474 macros
[0m18:06:03.103439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34e10390-4a6b-4301-8702-aa8ca07c1aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C8C0F790>]}
[0m18:06:03.105350 [info ] [MainThread]: 
[0m18:06:03.105943 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:03.106484 [info ] [MainThread]: 
[0m18:06:03.107804 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:06:03.113300 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m18:06:03.237097 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m18:06:03.237606 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m18:06:03.238006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:04.024010 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.786 seconds
[0m18:06:04.033296 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m18:06:04.072061 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m18:06:04.073781 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m18:06:04.075132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:04.558119 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.483 seconds
[0m18:06:04.569143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34e10390-4a6b-4301-8702-aa8ca07c1aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C8D3F1D0>]}
[0m18:06:04.590545 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m18:06:04.592936 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m18:06:04.595854 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m18:06:04.597450 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m18:06:04.622389 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m18:06:04.654741 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m18:06:04.738691 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m18:06:04.745000 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m18:06:04.745513 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM dev.raw.stocks_data
  );
[0m18:06:04.745970 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:05.514568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.768 seconds
[0m18:06:05.589689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e10390-4a6b-4301-8702-aa8ca07c1aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C8DF7540>]}
[0m18:06:05.590865 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.99s]
[0m18:06:05.592023 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m18:06:05.593004 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m18:06:05.593647 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.moving_avg .............................. [RUN]
[0m18:06:05.594468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m18:06:05.594952 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m18:06:05.597848 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m18:06:05.598891 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m18:06:05.625555 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m18:06:05.653773 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m18:06:05.654403 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS moving_avg_5d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m18:06:07.101084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.445 seconds
[0m18:06:07.109909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34e10390-4a6b-4301-8702-aa8ca07c1aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C9222D50>]}
[0m18:06:07.112572 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.51s]
[0m18:06:07.116102 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m18:06:07.121073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:07.122497 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m18:06:07.123907 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m18:06:07.253001 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m18:06:07.254341 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m18:06:07.606522 [debug] [MainThread]: Connection 'model.lab02_pair14.moving_avg' was left open.
[0m18:06:07.606993 [debug] [MainThread]: On model.lab02_pair14.moving_avg: Close
[0m18:06:07.697069 [info ] [MainThread]: 
[0m18:06:07.697799 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.59 seconds (4.59s).
[0m18:06:07.699050 [debug] [MainThread]: Command end result
[0m18:06:07.723020 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m18:06:07.725450 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m18:06:07.732493 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m18:06:07.732909 [info ] [MainThread]: 
[0m18:06:07.733663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:07.734309 [info ] [MainThread]: 
[0m18:06:07.734930 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:06:07.736130 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:07.735986 after 9.65 seconds
[0m18:06:07.736573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C90E8AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C8DF9DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267C6B371C0>]}
[0m18:06:07.737014 [debug] [MainThread]: Flushing usage events
[0m18:06:08.175039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:50:57.357646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828FFA9BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828DC92350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018290A36210>]}


============================== 00:50:57.363323 | 9dadf2de-6619-4a11-b24b-29353239a8a6 ==============================
[0m00:50:57.363323 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:50:57.363913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:50:58.245177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dadf2de-6619-4a11-b24b-29353239a8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018292C942B0>]}
[0m00:50:58.301239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dadf2de-6619-4a11-b24b-29353239a8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018292B649E0>]}
[0m00:50:58.302735 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:50:58.720814 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:50:59.656876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:50:59.657219 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:50:59.680527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dadf2de-6619-4a11-b24b-29353239a8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018292E34950>]}
[0m00:50:59.729845 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m00:50:59.742827 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m00:50:59.821300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dadf2de-6619-4a11-b24b-29353239a8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182909D88C0>]}
[0m00:50:59.821825 [info ] [MainThread]: Found 2 models, 474 macros
[0m00:50:59.822308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dadf2de-6619-4a11-b24b-29353239a8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018290D933F0>]}
[0m00:50:59.824054 [info ] [MainThread]: 
[0m00:50:59.824435 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:50:59.824784 [info ] [MainThread]: 
[0m00:50:59.825260 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:50:59.829493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m00:51:01.728825 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m00:51:01.729190 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m00:51:01.729474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:02.363346 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.634 seconds
[0m00:51:02.365948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m00:51:02.374721 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m00:51:02.375027 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m00:51:02.375296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:02.699856 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.325 seconds
[0m00:51:02.702691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dadf2de-6619-4a11-b24b-29353239a8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018293177930>]}
[0m00:51:02.710455 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m00:51:02.710897 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m00:51:02.711527 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m00:51:02.711851 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m00:51:02.717265 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m00:51:02.718500 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m00:51:02.747336 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m00:51:02.748570 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m00:51:02.748972 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM dev.raw.stocks_data
  );
[0m00:51:02.749328 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:51:03.490843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m00:51:03.512163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dadf2de-6619-4a11-b24b-29353239a8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018292FF7DD0>]}
[0m00:51:03.512742 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.80s]
[0m00:51:03.513535 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m00:51:03.514349 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m00:51:03.514772 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.moving_avg .............................. [RUN]
[0m00:51:03.515336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m00:51:03.515746 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m00:51:03.518183 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m00:51:03.518863 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m00:51:03.541008 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m00:51:03.542744 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m00:51:03.543371 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS moving_avg_5d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m00:51:04.821810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.278 seconds
[0m00:51:04.824074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dadf2de-6619-4a11-b24b-29353239a8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829341C890>]}
[0m00:51:04.824591 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.31s]
[0m00:51:04.825490 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m00:51:04.827040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:04.827289 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m00:51:04.827533 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m00:51:05.025954 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m00:51:05.026299 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m00:51:05.128116 [debug] [MainThread]: Connection 'model.lab02_pair14.moving_avg' was left open.
[0m00:51:05.128469 [debug] [MainThread]: On model.lab02_pair14.moving_avg: Close
[0m00:51:05.231036 [info ] [MainThread]: 
[0m00:51:05.231559 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.41 seconds (5.41s).
[0m00:51:05.232458 [debug] [MainThread]: Command end result
[0m00:51:05.249527 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m00:51:05.252572 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m00:51:05.259078 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m00:51:05.259459 [info ] [MainThread]: 
[0m00:51:05.259942 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:51:05.260356 [info ] [MainThread]: 
[0m00:51:05.261039 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:51:05.262011 [debug] [MainThread]: Command `dbt run` succeeded at 00:51:05.261897 after 8.27 seconds
[0m00:51:05.262443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182933A7BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182933732F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018292F3B7D0>]}
[0m00:51:05.262790 [debug] [MainThread]: Flushing usage events
[0m00:51:05.742110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:05:30.209162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118FD049BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118FAD32350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118FDAD6210>]}


============================== 01:05:30.214240 | f834a313-9309-4057-97e2-6a2138937c77 ==============================
[0m01:05:30.214240 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:05:30.214870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:05:30.674773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f834a313-9309-4057-97e2-6a2138937c77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118FFDF42B0>]}
[0m01:05:30.728869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f834a313-9309-4057-97e2-6a2138937c77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118FFCC49E0>]}
[0m01:05:30.730129 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m01:05:31.004747 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m01:05:31.139221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:05:31.139580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:05:31.164088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f834a313-9309-4057-97e2-6a2138937c77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118FFF94950>]}
[0m01:05:31.220128 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m01:05:31.224066 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m01:05:31.294828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f834a313-9309-4057-97e2-6a2138937c77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118FDA788C0>]}
[0m01:05:31.295377 [info ] [MainThread]: Found 2 models, 474 macros
[0m01:05:31.295849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f834a313-9309-4057-97e2-6a2138937c77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118FDE333F0>]}
[0m01:05:31.297276 [info ] [MainThread]: 
[0m01:05:31.297710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:05:31.298106 [info ] [MainThread]: 
[0m01:05:31.298692 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:05:31.302636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m01:05:31.390672 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m01:05:31.391319 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m01:05:31.391692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:05:32.051376 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.660 seconds
[0m01:05:32.054376 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m01:05:32.063354 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m01:05:32.063708 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m01:05:32.064014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:05:32.555653 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.492 seconds
[0m01:05:32.558538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f834a313-9309-4057-97e2-6a2138937c77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011880317930>]}
[0m01:05:32.564731 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m01:05:32.565548 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m01:05:32.566484 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m01:05:32.566846 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m01:05:32.572513 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m01:05:32.573177 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m01:05:32.600030 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m01:05:32.601411 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m01:05:32.601917 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM dev.raw.stocks_data
  );
[0m01:05:32.602392 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:05:33.412078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.810 seconds
[0m01:05:33.435661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f834a313-9309-4057-97e2-6a2138937c77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011880197F50>]}
[0m01:05:33.436223 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.87s]
[0m01:05:33.437404 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m01:05:33.438068 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m01:05:33.438483 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.moving_avg .............................. [RUN]
[0m01:05:33.439135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m01:05:33.439484 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m01:05:33.441849 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m01:05:33.442450 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m01:05:33.462846 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m01:05:33.464502 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m01:05:33.464925 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS moving_avg_5d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m01:05:34.389081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.924 seconds
[0m01:05:34.391014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f834a313-9309-4057-97e2-6a2138937c77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118805C03C0>]}
[0m01:05:34.391594 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 0.95s]
[0m01:05:34.392423 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m01:05:34.393528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:05:34.393811 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m01:05:34.394092 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m01:05:34.518884 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m01:05:34.519416 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m01:05:34.700959 [debug] [MainThread]: Connection 'model.lab02_pair14.moving_avg' was left open.
[0m01:05:34.701332 [debug] [MainThread]: On model.lab02_pair14.moving_avg: Close
[0m01:05:34.808420 [info ] [MainThread]: 
[0m01:05:34.809019 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m01:05:34.810076 [debug] [MainThread]: Command end result
[0m01:05:34.827732 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m01:05:34.829564 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m01:05:34.835779 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m01:05:34.836340 [info ] [MainThread]: 
[0m01:05:34.837006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:05:34.837571 [info ] [MainThread]: 
[0m01:05:34.838091 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:05:34.839852 [debug] [MainThread]: Command `dbt run` succeeded at 01:05:34.839514 after 4.88 seconds
[0m01:05:34.840447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011880547750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011880513020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000118FB0073D0>]}
[0m01:05:34.840829 [debug] [MainThread]: Flushing usage events
[0m01:05:35.314227 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:00:27.670140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288ED12DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288EAE12350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288EDBB6210>]}


============================== 02:00:27.676561 | 4d955c56-6e6a-4cf4-94c5-965eb740a47b ==============================
[0m02:00:27.676561 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:00:27.677597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:00:28.425730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d955c56-6e6a-4cf4-94c5-965eb740a47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288EFD842B0>]}
[0m02:00:28.478887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d955c56-6e6a-4cf4-94c5-965eb740a47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288EFC549E0>]}
[0m02:00:28.480202 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:00:28.882551 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m02:00:29.405204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:00:29.405579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:00:29.429211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d955c56-6e6a-4cf4-94c5-965eb740a47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288EFF24950>]}
[0m02:00:29.478750 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:00:29.482807 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:00:29.551645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d955c56-6e6a-4cf4-94c5-965eb740a47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288EDB588C0>]}
[0m02:00:29.552101 [info ] [MainThread]: Found 2 models, 474 macros
[0m02:00:29.552563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d955c56-6e6a-4cf4-94c5-965eb740a47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288EDF133F0>]}
[0m02:00:29.553945 [info ] [MainThread]: 
[0m02:00:29.554384 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:00:29.554792 [info ] [MainThread]: 
[0m02:00:29.555332 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:00:29.559181 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m02:00:30.693548 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m02:00:30.693952 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m02:00:30.694245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:31.198868 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.505 seconds
[0m02:00:31.202018 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m02:00:31.212877 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m02:00:31.213331 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m02:00:31.213656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:00:31.531826 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.318 seconds
[0m02:00:31.534317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d955c56-6e6a-4cf4-94c5-965eb740a47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F026B930>]}
[0m02:00:31.538495 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m02:00:31.538951 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m02:00:31.539543 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m02:00:31.539868 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m02:00:31.545102 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m02:00:31.545933 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m02:00:31.573105 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m02:00:31.574454 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m02:00:31.574821 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM dev.raw.stocks_data
  );
[0m02:00:31.575179 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:00:32.174436 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m02:00:32.193695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d955c56-6e6a-4cf4-94c5-965eb740a47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F00C7F50>]}
[0m02:00:32.194277 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.65s]
[0m02:00:32.195009 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m02:00:32.195666 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m02:00:32.196083 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.moving_avg .............................. [RUN]
[0m02:00:32.196692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m02:00:32.197023 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m02:00:32.199457 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m02:00:32.200067 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m02:00:32.221890 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m02:00:32.223217 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m02:00:32.223608 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS moving_avg_5d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m02:00:33.220361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.996 seconds
[0m02:00:33.222127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d955c56-6e6a-4cf4-94c5-965eb740a47b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F0514310>]}
[0m02:00:33.222654 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.03s]
[0m02:00:33.223441 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m02:00:33.224673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:00:33.224943 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m02:00:33.225204 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m02:00:33.358799 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m02:00:33.359171 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m02:00:33.473826 [debug] [MainThread]: Connection 'model.lab02_pair14.moving_avg' was left open.
[0m02:00:33.474174 [debug] [MainThread]: On model.lab02_pair14.moving_avg: Close
[0m02:00:33.585792 [info ] [MainThread]: 
[0m02:00:33.586378 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m02:00:33.587382 [debug] [MainThread]: Command end result
[0m02:00:33.606830 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:00:33.609289 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:00:33.615456 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m02:00:33.615830 [info ] [MainThread]: 
[0m02:00:33.616370 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:00:33.616907 [info ] [MainThread]: 
[0m02:00:33.617426 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:00:33.618515 [debug] [MainThread]: Command `dbt run` succeeded at 02:00:33.618388 after 6.21 seconds
[0m02:00:33.618878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F049BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288F0467020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288EFD22DD0>]}
[0m02:00:33.619230 [debug] [MainThread]: Flushing usage events
[0m02:00:33.940265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:15.938818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD37119BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD34DB6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD37BA6210>]}


============================== 02:03:15.942726 | ea86f301-7ed4-4b9d-89e2-0747f7145092 ==============================
[0m02:03:15.942726 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:03:15.943371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:03:16.357757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea86f301-7ed4-4b9d-89e2-0747f7145092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD39D842B0>]}
[0m02:03:16.419956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea86f301-7ed4-4b9d-89e2-0747f7145092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD39C649E0>]}
[0m02:03:16.421268 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:03:16.702669 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m02:03:16.821224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:03:16.821736 [debug] [MainThread]: Partial parsing: updated file: lab02_pair14://models\stock_metrics\moving_avg.sql
[0m02:03:17.079129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea86f301-7ed4-4b9d-89e2-0747f7145092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD39F24750>]}
[0m02:03:17.126154 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:03:17.129131 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:03:17.151347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea86f301-7ed4-4b9d-89e2-0747f7145092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD37B488C0>]}
[0m02:03:17.151812 [info ] [MainThread]: Found 2 models, 474 macros
[0m02:03:17.152289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea86f301-7ed4-4b9d-89e2-0747f7145092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD39C773F0>]}
[0m02:03:17.153716 [info ] [MainThread]: 
[0m02:03:17.154200 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:03:17.154659 [info ] [MainThread]: 
[0m02:03:17.155253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:03:17.159091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m02:03:17.238659 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m02:03:17.239020 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m02:03:17.239307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:17.753608 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.514 seconds
[0m02:03:17.756149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m02:03:17.764829 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m02:03:17.765166 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m02:03:17.765468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:03:18.194452 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.429 seconds
[0m02:03:18.197188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea86f301-7ed4-4b9d-89e2-0747f7145092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD3A3BD8B0>]}
[0m02:03:18.201063 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m02:03:18.201628 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m02:03:18.202380 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m02:03:18.202702 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m02:03:18.208218 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m02:03:18.208838 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m02:03:18.237836 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m02:03:18.238766 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m02:03:18.239098 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM dev.raw.stocks_data
  );
[0m02:03:18.239407 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:03:18.881350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m02:03:18.900623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea86f301-7ed4-4b9d-89e2-0747f7145092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD3A153F50>]}
[0m02:03:18.901230 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.70s]
[0m02:03:18.902550 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m02:03:18.903218 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m02:03:18.903653 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.moving_avg .............................. [RUN]
[0m02:03:18.904242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m02:03:18.904576 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m02:03:18.906598 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m02:03:18.907201 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m02:03:18.929397 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m02:03:18.931242 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m02:03:18.931972 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM (
        SELECT DISTINCT symbol, date, close
        FROM USER_DB_BOA.analytics.raw_stocks_data
    )
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS moving_avg_5d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m02:03:19.771531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.839 seconds
[0m02:03:19.773381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea86f301-7ed4-4b9d-89e2-0747f7145092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD3A641440>]}
[0m02:03:19.773900 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 0.87s]
[0m02:03:19.774658 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m02:03:19.775775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:03:19.776039 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m02:03:19.776288 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m02:03:19.893862 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m02:03:19.894228 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m02:03:20.013832 [debug] [MainThread]: Connection 'model.lab02_pair14.moving_avg' was left open.
[0m02:03:20.014180 [debug] [MainThread]: On model.lab02_pair14.moving_avg: Close
[0m02:03:20.150620 [info ] [MainThread]: 
[0m02:03:20.151259 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m02:03:20.152366 [debug] [MainThread]: Command end result
[0m02:03:20.170885 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:03:20.173187 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:03:20.179478 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m02:03:20.179830 [info ] [MainThread]: 
[0m02:03:20.180392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:03:20.180874 [info ] [MainThread]: 
[0m02:03:20.181372 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:03:20.182396 [debug] [MainThread]: Command `dbt run` succeeded at 02:03:20.182268 after 4.48 seconds
[0m02:03:20.182752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD3A47F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD3A4CFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD39FFD3D0>]}
[0m02:03:20.183311 [debug] [MainThread]: Flushing usage events
[0m02:03:20.518800 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:04:30.141821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68EE1DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68CAC6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68F8A6210>]}


============================== 02:04:30.145887 | 133d8d23-b968-4d96-b9e1-59cd9a0efa21 ==============================
[0m02:04:30.145887 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:04:30.146541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:04:30.544199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '133d8d23-b968-4d96-b9e1-59cd9a0efa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B691A342B0>]}
[0m02:04:30.596279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '133d8d23-b968-4d96-b9e1-59cd9a0efa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6919049E0>]}
[0m02:04:30.597647 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:04:30.877011 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m02:04:31.021326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:04:31.021874 [debug] [MainThread]: Partial parsing: updated file: lab02_pair14://models\raw_stocks_data.sql
[0m02:04:31.022288 [debug] [MainThread]: Partial parsing: updated file: lab02_pair14://models\stock_metrics\moving_avg.sql
[0m02:04:31.319231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '133d8d23-b968-4d96-b9e1-59cd9a0efa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B691BD4750>]}
[0m02:04:31.372315 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:04:31.375626 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:04:31.400863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '133d8d23-b968-4d96-b9e1-59cd9a0efa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B68F8488C0>]}
[0m02:04:31.401348 [info ] [MainThread]: Found 2 models, 474 macros
[0m02:04:31.401884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '133d8d23-b968-4d96-b9e1-59cd9a0efa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B691927150>]}
[0m02:04:31.403444 [info ] [MainThread]: 
[0m02:04:31.404005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:04:31.404433 [info ] [MainThread]: 
[0m02:04:31.405141 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:04:31.409246 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m02:04:31.492014 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m02:04:31.492390 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m02:04:31.492686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:32.100151 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.607 seconds
[0m02:04:32.102940 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m02:04:32.111356 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m02:04:32.111885 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m02:04:32.112427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:32.511561 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.399 seconds
[0m02:04:32.514661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '133d8d23-b968-4d96-b9e1-59cd9a0efa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B69206DE60>]}
[0m02:04:32.518132 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m02:04:32.518624 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m02:04:32.519244 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m02:04:32.519641 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m02:04:32.525254 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m02:04:32.525905 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m02:04:32.556102 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m02:04:32.557094 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m02:04:32.557477 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM user_db_boa.raw.stocks_data
  );
[0m02:04:32.557830 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:04:33.123801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m02:04:33.144839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '133d8d23-b968-4d96-b9e1-59cd9a0efa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B691E2BE90>]}
[0m02:04:33.145413 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.62s]
[0m02:04:33.146346 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m02:04:33.147021 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m02:04:33.147625 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.moving_avg .............................. [RUN]
[0m02:04:33.148182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m02:04:33.148517 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m02:04:33.150511 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m02:04:33.151148 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m02:04:33.176545 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m02:04:33.178544 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m02:04:33.179045 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS moving_avg_5d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m02:04:34.102664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.923 seconds
[0m02:04:34.104842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '133d8d23-b968-4d96-b9e1-59cd9a0efa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B691E09700>]}
[0m02:04:34.105468 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 0.96s]
[0m02:04:34.106384 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m02:04:34.107534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:34.107806 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m02:04:34.108067 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m02:04:34.293312 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m02:04:34.293801 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m02:04:34.461263 [debug] [MainThread]: Connection 'model.lab02_pair14.moving_avg' was left open.
[0m02:04:34.461910 [debug] [MainThread]: On model.lab02_pair14.moving_avg: Close
[0m02:04:34.613157 [info ] [MainThread]: 
[0m02:04:34.614093 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m02:04:34.615532 [debug] [MainThread]: Command end result
[0m02:04:34.636716 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:04:34.639032 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:04:34.645170 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m02:04:34.645735 [info ] [MainThread]: 
[0m02:04:34.646568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:04:34.647457 [info ] [MainThread]: 
[0m02:04:34.648369 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:04:34.650331 [debug] [MainThread]: Command `dbt run` succeeded at 02:04:34.650192 after 4.72 seconds
[0m02:04:34.650897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B692133430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B69217FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B691CAD3D0>]}
[0m02:04:34.651352 [debug] [MainThread]: Flushing usage events
[0m02:04:35.150229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:12:19.777539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244855B9BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024483292350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024486046210>]}


============================== 02:12:19.783111 | cfafe6f6-1453-430a-b707-9ccd237d2bc3 ==============================
[0m02:12:19.783111 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:12:19.783675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:12:20.226798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfafe6f6-1453-430a-b707-9ccd237d2bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244882102B0>]}
[0m02:12:20.280840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfafe6f6-1453-430a-b707-9ccd237d2bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244880C49E0>]}
[0m02:12:20.282145 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:12:20.555548 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m02:12:20.709313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m02:12:20.709788 [debug] [MainThread]: Partial parsing: added file: lab02_pair14://models\stock_metrics\rsi.sql
[0m02:12:20.710110 [debug] [MainThread]: Partial parsing: added file: lab02_pair14://models\stock_metrics\volatility.sql
[0m02:12:20.710412 [debug] [MainThread]: Partial parsing: added file: lab02_pair14://models\stock_metrics\price_momentum.sql
[0m02:12:20.970411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfafe6f6-1453-430a-b707-9ccd237d2bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024488394750>]}
[0m02:12:21.015620 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:12:21.018748 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:12:21.050415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfafe6f6-1453-430a-b707-9ccd237d2bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024485FE88C0>]}
[0m02:12:21.050884 [info ] [MainThread]: Found 5 models, 474 macros
[0m02:12:21.051357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfafe6f6-1453-430a-b707-9ccd237d2bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244880E7070>]}
[0m02:12:21.053288 [info ] [MainThread]: 
[0m02:12:21.053918 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:12:21.054400 [info ] [MainThread]: 
[0m02:12:21.055012 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:12:21.059711 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m02:12:21.144753 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m02:12:21.145252 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m02:12:21.145587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:12:21.607288 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.462 seconds
[0m02:12:21.610388 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m02:12:21.619438 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m02:12:21.619965 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m02:12:21.620281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:12:22.001438 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.381 seconds
[0m02:12:22.004524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfafe6f6-1453-430a-b707-9ccd237d2bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024488832A90>]}
[0m02:12:22.009492 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m02:12:22.009966 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m02:12:22.010613 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m02:12:22.010962 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m02:12:22.016342 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m02:12:22.017169 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m02:12:22.048857 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m02:12:22.049817 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m02:12:22.050194 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM user_db_boa.raw.stocks_data
  );
[0m02:12:22.050529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:12:22.712252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m02:12:22.733262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfafe6f6-1453-430a-b707-9ccd237d2bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244885D3DD0>]}
[0m02:12:22.733841 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.72s]
[0m02:12:22.734559 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m02:12:22.735410 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m02:12:22.735840 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.moving_avg .............................. [RUN]
[0m02:12:22.736662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m02:12:22.737031 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m02:12:22.738996 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m02:12:22.739616 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m02:12:22.760653 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m02:12:22.762126 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m02:12:22.762533 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS moving_avg_5d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m02:12:24.224988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.462 seconds
[0m02:12:24.226893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfafe6f6-1453-430a-b707-9ccd237d2bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244886254F0>]}
[0m02:12:24.227422 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.49s]
[0m02:12:24.228118 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m02:12:24.228478 [debug] [Thread-1 (]: Began running node model.lab02_pair14.price_momentum
[0m02:12:24.228866 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.price_momentum .......................... [RUN]
[0m02:12:24.229399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.moving_avg, now model.lab02_pair14.price_momentum)
[0m02:12:24.229717 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.price_momentum
[0m02:12:24.231643 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.price_momentum"
[0m02:12:24.232313 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.price_momentum
[0m02:12:24.236022 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.price_momentum"
[0m02:12:24.237610 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.price_momentum"
[0m02:12:24.238233 [debug] [Thread-1 (]: On model.lab02_pair14.price_momentum: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.price_momentum"} */
create or replace transient table USER_DB_BOA.analytics.price_momentum
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close, 5) OVER (PARTITION BY symbol ORDER BY date) AS close_5_days_ago
    FROM USER_DB_BOA.analytics.raw_stocks_data
)

SELECT
    symbol,
    date,
    close,
    close_5_days_ago,
    close - close_5_days_ago AS price_momentum
FROM base
WHERE close_5_days_ago IS NOT NULL
        );
[0m02:12:25.086125 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.847 seconds
[0m02:12:25.087984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfafe6f6-1453-430a-b707-9ccd237d2bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024488ABEA30>]}
[0m02:12:25.088533 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.price_momentum ..................... [[32mSUCCESS 1[0m in 0.86s]
[0m02:12:25.089235 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.price_momentum
[0m02:12:25.089590 [debug] [Thread-1 (]: Began running node model.lab02_pair14.rsi
[0m02:12:25.089986 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m02:12:25.090503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.price_momentum, now model.lab02_pair14.rsi)
[0m02:12:25.090828 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.rsi
[0m02:12:25.092911 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.rsi"
[0m02:12:25.093630 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.rsi
[0m02:12:25.096023 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.rsi"
[0m02:12:25.097625 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.rsi"
[0m02:12:25.098023 [debug] [Thread-1 (]: On model.lab02_pair14.rsi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.rsi"} */
create or replace transient table USER_DB_BOA.analytics.rsi
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        CASE WHEN close - prev_close > 0 THEN close - prev_close ELSE 0 END AS gain,
        CASE WHEN close - prev_close < 0 THEN ABS(close - prev_close) ELSE 0 END AS loss
    FROM base
    WHERE prev_close IS NOT NULL
),

rsi_calc AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        AVG(loss) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM gains_losses
)

SELECT
    symbol,
    date,
    100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))) AS rsi_14d
FROM rsi_calc
        );
[0m02:12:26.634388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.536 seconds
[0m02:12:26.637036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfafe6f6-1453-430a-b707-9ccd237d2bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244889077D0>]}
[0m02:12:26.637972 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.55s]
[0m02:12:26.639206 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.rsi
[0m02:12:26.639693 [debug] [Thread-1 (]: Began running node model.lab02_pair14.volatility
[0m02:12:26.640698 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.volatility .............................. [RUN]
[0m02:12:26.641698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.rsi, now model.lab02_pair14.volatility)
[0m02:12:26.642347 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.volatility
[0m02:12:26.645299 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.volatility"
[0m02:12:26.646065 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.volatility
[0m02:12:26.649068 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.volatility"
[0m02:12:26.651170 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.volatility"
[0m02:12:26.651574 [debug] [Thread-1 (]: On model.lab02_pair14.volatility: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.volatility"} */
create or replace transient table USER_DB_BOA.analytics.volatility
         as
        (WITH returns AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

daily_returns AS (
    SELECT 
        symbol,
        date,
        (close - prev_close) / prev_close AS daily_return
    FROM returns
    WHERE prev_close IS NOT NULL
)

SELECT
    symbol,
    date,
    STDDEV_SAMP(daily_return) OVER (
        PARTITION BY symbol ORDER BY date ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
    ) AS volatility_10d
FROM daily_returns
        );
[0m02:12:27.258573 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m02:12:27.260292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfafe6f6-1453-430a-b707-9ccd237d2bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244885635B0>]}
[0m02:12:27.260806 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.volatility ......................... [[32mSUCCESS 1[0m in 0.62s]
[0m02:12:27.261502 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.volatility
[0m02:12:27.262796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:12:27.263059 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m02:12:27.263323 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m02:12:27.383047 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m02:12:27.383393 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m02:12:27.505071 [debug] [MainThread]: Connection 'model.lab02_pair14.volatility' was left open.
[0m02:12:27.505428 [debug] [MainThread]: On model.lab02_pair14.volatility: Close
[0m02:12:27.626403 [info ] [MainThread]: 
[0m02:12:27.627138 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 6.57 seconds (6.57s).
[0m02:12:27.628760 [debug] [MainThread]: Command end result
[0m02:12:27.648836 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:12:27.651793 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:12:27.658853 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m02:12:27.659305 [info ] [MainThread]: 
[0m02:12:27.659792 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:12:27.660218 [info ] [MainThread]: 
[0m02:12:27.660626 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m02:12:27.661904 [debug] [MainThread]: Command `dbt run` succeeded at 02:12:27.661617 after 8.13 seconds
[0m02:12:27.662539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244852F1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024486406BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024488B1C710>]}
[0m02:12:27.662972 [debug] [MainThread]: Flushing usage events
[0m02:12:28.071051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:16:18.296269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B302449BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B300156350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B302ED6210>]}


============================== 02:16:18.300290 | 53e256ed-2fb4-45b2-a7dd-da2b34af5ed0 ==============================
[0m02:16:18.300290 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:16:18.300907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:16:18.733730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53e256ed-2fb4-45b2-a7dd-da2b34af5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3050A42B0>]}
[0m02:16:18.791538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53e256ed-2fb4-45b2-a7dd-da2b34af5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B304F749E0>]}
[0m02:16:18.792908 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:16:19.096883 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m02:16:19.222708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:16:19.223210 [debug] [MainThread]: Partial parsing: updated file: lab02_pair14://models\stock_metrics\rsi.sql
[0m02:16:19.480564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53e256ed-2fb4-45b2-a7dd-da2b34af5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B305244650>]}
[0m02:16:19.527257 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:16:19.530167 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:16:19.552595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e256ed-2fb4-45b2-a7dd-da2b34af5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B302E788C0>]}
[0m02:16:19.553049 [info ] [MainThread]: Found 5 models, 474 macros
[0m02:16:19.553626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53e256ed-2fb4-45b2-a7dd-da2b34af5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B304F973F0>]}
[0m02:16:19.555460 [info ] [MainThread]: 
[0m02:16:19.556210 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:16:19.556817 [info ] [MainThread]: 
[0m02:16:19.557597 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:16:19.561801 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m02:16:19.647256 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m02:16:19.647626 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m02:16:19.647922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:20.414268 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.766 seconds
[0m02:16:20.417040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m02:16:20.424827 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m02:16:20.425128 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m02:16:20.425406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:16:20.848588 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.423 seconds
[0m02:16:20.851805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53e256ed-2fb4-45b2-a7dd-da2b34af5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3056E2B60>]}
[0m02:16:20.855495 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m02:16:20.855929 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m02:16:20.856602 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m02:16:20.856920 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m02:16:20.861988 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m02:16:20.862619 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m02:16:20.892334 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m02:16:20.893444 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m02:16:20.893823 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM user_db_boa.raw.stocks_data
  );
[0m02:16:20.894138 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:16:21.491917 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.598 seconds
[0m02:16:21.513314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53e256ed-2fb4-45b2-a7dd-da2b34af5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B30549FDD0>]}
[0m02:16:21.513869 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.66s]
[0m02:16:21.514763 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m02:16:21.515792 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m02:16:21.516328 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.moving_avg .............................. [RUN]
[0m02:16:21.517005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m02:16:21.517327 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m02:16:21.519674 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m02:16:21.520278 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m02:16:21.543641 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m02:16:21.545780 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m02:16:21.546467 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        close,
        AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS moving_avg_5d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m02:16:22.312572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m02:16:22.314452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53e256ed-2fb4-45b2-a7dd-da2b34af5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3058E5B20>]}
[0m02:16:22.314977 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 0.80s]
[0m02:16:22.316044 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m02:16:22.316428 [debug] [Thread-1 (]: Began running node model.lab02_pair14.price_momentum
[0m02:16:22.316969 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.price_momentum .......................... [RUN]
[0m02:16:22.317703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.moving_avg, now model.lab02_pair14.price_momentum)
[0m02:16:22.318348 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.price_momentum
[0m02:16:22.322395 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.price_momentum"
[0m02:16:22.323288 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.price_momentum
[0m02:16:22.325984 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.price_momentum"
[0m02:16:22.327164 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.price_momentum"
[0m02:16:22.327583 [debug] [Thread-1 (]: On model.lab02_pair14.price_momentum: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.price_momentum"} */
create or replace transient table USER_DB_BOA.analytics.price_momentum
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close, 5) OVER (PARTITION BY symbol ORDER BY date) AS close_5_days_ago
    FROM USER_DB_BOA.analytics.raw_stocks_data
)

SELECT
    symbol,
    date,
    close,
    close_5_days_ago,
    close - close_5_days_ago AS price_momentum
FROM base
WHERE close_5_days_ago IS NOT NULL
        );
[0m02:16:23.143521 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m02:16:23.145482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53e256ed-2fb4-45b2-a7dd-da2b34af5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3059D4050>]}
[0m02:16:23.146020 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.price_momentum ..................... [[32mSUCCESS 1[0m in 0.83s]
[0m02:16:23.147064 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.price_momentum
[0m02:16:23.147465 [debug] [Thread-1 (]: Began running node model.lab02_pair14.rsi
[0m02:16:23.147871 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m02:16:23.148583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.price_momentum, now model.lab02_pair14.rsi)
[0m02:16:23.148948 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.rsi
[0m02:16:23.152229 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.rsi"
[0m02:16:23.153536 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.rsi
[0m02:16:23.156174 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.rsi"
[0m02:16:23.157849 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.rsi"
[0m02:16:23.158632 [debug] [Thread-1 (]: On model.lab02_pair14.rsi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.rsi"} */
create or replace transient table USER_DB_BOA.analytics.rsi
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        CASE WHEN close - prev_close > 0 THEN close - prev_close ELSE 0 END AS gain,
        CASE WHEN close - prev_close < 0 THEN ABS(close - prev_close) ELSE 0 END AS loss
    FROM base
    WHERE prev_close IS NOT NULL
),

rsi_calc AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        AVG(loss) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM gains_losses
)

SELECT
    symbol,
    date,
    round(100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))), 2) AS rsi_14d
FROM rsi_calc
        );
[0m02:16:24.028655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.869 seconds
[0m02:16:24.032850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53e256ed-2fb4-45b2-a7dd-da2b34af5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3057B7250>]}
[0m02:16:24.033965 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 0.88s]
[0m02:16:24.035262 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.rsi
[0m02:16:24.035984 [debug] [Thread-1 (]: Began running node model.lab02_pair14.volatility
[0m02:16:24.037039 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.volatility .............................. [RUN]
[0m02:16:24.038350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.rsi, now model.lab02_pair14.volatility)
[0m02:16:24.039049 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.volatility
[0m02:16:24.043525 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.volatility"
[0m02:16:24.044487 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.volatility
[0m02:16:24.050657 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.volatility"
[0m02:16:24.053191 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.volatility"
[0m02:16:24.054038 [debug] [Thread-1 (]: On model.lab02_pair14.volatility: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.volatility"} */
create or replace transient table USER_DB_BOA.analytics.volatility
         as
        (WITH returns AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

daily_returns AS (
    SELECT 
        symbol,
        date,
        (close - prev_close) / prev_close AS daily_return
    FROM returns
    WHERE prev_close IS NOT NULL
)

SELECT
    symbol,
    date,
    STDDEV_SAMP(daily_return) OVER (
        PARTITION BY symbol ORDER BY date ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
    ) AS volatility_10d
FROM daily_returns
        );
[0m02:16:24.692094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.637 seconds
[0m02:16:24.694013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53e256ed-2fb4-45b2-a7dd-da2b34af5ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3059FB620>]}
[0m02:16:24.694558 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.volatility ......................... [[32mSUCCESS 1[0m in 0.66s]
[0m02:16:24.695408 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.volatility
[0m02:16:24.696512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:16:24.696782 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m02:16:24.697049 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m02:16:24.823452 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m02:16:24.823801 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m02:16:24.930653 [debug] [MainThread]: Connection 'model.lab02_pair14.volatility' was left open.
[0m02:16:24.931026 [debug] [MainThread]: On model.lab02_pair14.volatility: Close
[0m02:16:25.033552 [info ] [MainThread]: 
[0m02:16:25.034260 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m02:16:25.035669 [debug] [MainThread]: Command end result
[0m02:16:25.054654 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:16:25.056768 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:16:25.063959 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m02:16:25.064493 [info ] [MainThread]: 
[0m02:16:25.065210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:16:25.065865 [info ] [MainThread]: 
[0m02:16:25.066589 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m02:16:25.067849 [debug] [MainThread]: Command `dbt run` succeeded at 02:16:25.067730 after 7.01 seconds
[0m02:16:25.068208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B30214A630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B30324A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3059CCDD0>]}
[0m02:16:25.068778 [debug] [MainThread]: Flushing usage events
[0m02:16:25.621855 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:18:43.959283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE54889BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE52536350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE55316210>]}


============================== 02:18:43.963210 | da2557e4-8c8c-493f-8c8e-ffca845fee88 ==============================
[0m02:18:43.963210 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:18:43.963808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:18:44.361313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da2557e4-8c8c-493f-8c8e-ffca845fee88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE575042B0>]}
[0m02:18:44.416685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da2557e4-8c8c-493f-8c8e-ffca845fee88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE573D49E0>]}
[0m02:18:44.417983 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:18:44.682465 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m02:18:44.820334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m02:18:44.820865 [debug] [MainThread]: Partial parsing: updated file: lab02_pair14://models\stock_metrics\volatility.sql
[0m02:18:44.821333 [debug] [MainThread]: Partial parsing: updated file: lab02_pair14://models\stock_metrics\moving_avg.sql
[0m02:18:44.821700 [debug] [MainThread]: Partial parsing: updated file: lab02_pair14://models\stock_metrics\price_momentum.sql
[0m02:18:45.082267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da2557e4-8c8c-493f-8c8e-ffca845fee88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE576A4750>]}
[0m02:18:45.128645 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:18:45.131405 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:18:45.155292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da2557e4-8c8c-493f-8c8e-ffca845fee88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE552B88C0>]}
[0m02:18:45.155698 [info ] [MainThread]: Found 5 models, 474 macros
[0m02:18:45.156232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da2557e4-8c8c-493f-8c8e-ffca845fee88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE573F7070>]}
[0m02:18:45.157877 [info ] [MainThread]: 
[0m02:18:45.158280 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:18:45.158944 [info ] [MainThread]: 
[0m02:18:45.159571 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:18:45.163732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m02:18:45.242497 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m02:18:45.242871 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m02:18:45.243170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:45.711991 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.469 seconds
[0m02:18:45.714431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m02:18:45.722773 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m02:18:45.723189 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m02:18:45.723601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:46.089636 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.366 seconds
[0m02:18:46.092994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da2557e4-8c8c-493f-8c8e-ffca845fee88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE57B46A90>]}
[0m02:18:46.096721 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m02:18:46.097181 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m02:18:46.097860 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m02:18:46.098183 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m02:18:46.103386 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m02:18:46.104141 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m02:18:46.129546 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m02:18:46.130460 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m02:18:46.130837 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM user_db_boa.raw.stocks_data
  );
[0m02:18:46.131170 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:18:46.749905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.619 seconds
[0m02:18:46.772396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da2557e4-8c8c-493f-8c8e-ffca845fee88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5790B4D0>]}
[0m02:18:46.773002 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.67s]
[0m02:18:46.773821 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m02:18:46.774627 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m02:18:46.775073 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.moving_avg .............................. [RUN]
[0m02:18:46.775720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m02:18:46.776065 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m02:18:46.778481 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m02:18:46.779210 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m02:18:46.803255 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m02:18:46.804886 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m02:18:46.805373 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        round(close, 2),
        round(AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 4 PRECEDING AND CURRENT ROW), 2) AS moving_avg_5d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m02:18:47.816621 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.011 seconds
[0m02:18:47.818811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da2557e4-8c8c-493f-8c8e-ffca845fee88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE578DD910>]}
[0m02:18:47.819414 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.04s]
[0m02:18:47.820204 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m02:18:47.820586 [debug] [Thread-1 (]: Began running node model.lab02_pair14.price_momentum
[0m02:18:47.821145 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.price_momentum .......................... [RUN]
[0m02:18:47.821706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.moving_avg, now model.lab02_pair14.price_momentum)
[0m02:18:47.822054 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.price_momentum
[0m02:18:47.824441 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.price_momentum"
[0m02:18:47.825086 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.price_momentum
[0m02:18:47.827344 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.price_momentum"
[0m02:18:47.828483 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.price_momentum"
[0m02:18:47.828860 [debug] [Thread-1 (]: On model.lab02_pair14.price_momentum: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.price_momentum"} */
create or replace transient table USER_DB_BOA.analytics.price_momentum
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close, 5) OVER (PARTITION BY symbol ORDER BY date) AS close_5_days_ago
    FROM USER_DB_BOA.analytics.raw_stocks_data
)

SELECT
    symbol,
    date,
    round(close, 2),
    round(close_5_days_ago, 2),
    round(close - close_5_days_ago, 2) AS price_momentum
FROM base
WHERE close_5_days_ago IS NOT NULL
        );
[0m02:18:48.274596 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0ce-0305-0bd9-0004-59ff002b6de2
[0m02:18:48.275280 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m02:18:48.297556 [debug] [Thread-1 (]: Database Error in model price_momentum (models\stock_metrics\price_momentum.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\lab02_pair14\models\stock_metrics\price_momentum.sql
[0m02:18:48.298069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da2557e4-8c8c-493f-8c8e-ffca845fee88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE557F3E30>]}
[0m02:18:48.298674 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.price_momentum ................. [[31mERROR[0m in 0.48s]
[0m02:18:48.299455 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.price_momentum
[0m02:18:48.299965 [debug] [Thread-1 (]: Began running node model.lab02_pair14.rsi
[0m02:18:48.301126 [debug] [Thread-4 (]: Marking all children of 'model.lab02_pair14.price_momentum' to be skipped because of status 'error'.  Reason: Database Error in model price_momentum (models\stock_metrics\price_momentum.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\lab02_pair14\models\stock_metrics\price_momentum.sql.
[0m02:18:48.300569 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m02:18:48.302366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.price_momentum, now model.lab02_pair14.rsi)
[0m02:18:48.302737 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.rsi
[0m02:18:48.305109 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.rsi"
[0m02:18:48.305854 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.rsi
[0m02:18:48.308717 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.rsi"
[0m02:18:48.310190 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.rsi"
[0m02:18:48.310575 [debug] [Thread-1 (]: On model.lab02_pair14.rsi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.rsi"} */
create or replace transient table USER_DB_BOA.analytics.rsi
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        CASE WHEN close - prev_close > 0 THEN close - prev_close ELSE 0 END AS gain,
        CASE WHEN close - prev_close < 0 THEN ABS(close - prev_close) ELSE 0 END AS loss
    FROM base
    WHERE prev_close IS NOT NULL
),

rsi_calc AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        AVG(loss) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM gains_losses
)

SELECT
    symbol,
    date,
    round(100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))), 2) AS rsi_14d
FROM rsi_calc
        );
[0m02:18:48.880738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m02:18:48.882890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da2557e4-8c8c-493f-8c8e-ffca845fee88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE57C244D0>]}
[0m02:18:48.883433 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 0.58s]
[0m02:18:48.884290 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.rsi
[0m02:18:48.884714 [debug] [Thread-1 (]: Began running node model.lab02_pair14.volatility
[0m02:18:48.885195 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.volatility .............................. [RUN]
[0m02:18:48.885737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.rsi, now model.lab02_pair14.volatility)
[0m02:18:48.886066 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.volatility
[0m02:18:48.888129 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.volatility"
[0m02:18:48.888786 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.volatility
[0m02:18:48.891236 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.volatility"
[0m02:18:48.892640 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.volatility"
[0m02:18:48.893017 [debug] [Thread-1 (]: On model.lab02_pair14.volatility: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.volatility"} */
create or replace transient table USER_DB_BOA.analytics.volatility
         as
        (WITH returns AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

daily_returns AS (
    SELECT 
        symbol,
        date,
        (close - prev_close) / prev_close AS daily_return
    FROM returns
    WHERE prev_close IS NOT NULL
)

SELECT
    symbol,
    date,
    round(STDDEV_SAMP(daily_return) OVER (
        PARTITION BY symbol ORDER BY date ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
    ), 2) AS volatility_10d
FROM daily_returns
        );
[0m02:18:49.673679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.780 seconds
[0m02:18:49.675634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da2557e4-8c8c-493f-8c8e-ffca845fee88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE57F229E0>]}
[0m02:18:49.676243 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.volatility ......................... [[32mSUCCESS 1[0m in 0.79s]
[0m02:18:49.677009 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.volatility
[0m02:18:49.678118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:49.678444 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m02:18:49.678727 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m02:18:49.790352 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m02:18:49.790722 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m02:18:49.914715 [debug] [MainThread]: Connection 'model.lab02_pair14.volatility' was left open.
[0m02:18:49.915073 [debug] [MainThread]: On model.lab02_pair14.volatility: Close
[0m02:18:50.021289 [info ] [MainThread]: 
[0m02:18:50.021830 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 4.86 seconds (4.86s).
[0m02:18:50.023203 [debug] [MainThread]: Command end result
[0m02:18:50.042092 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:18:50.044634 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:18:50.051513 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m02:18:50.051919 [info ] [MainThread]: 
[0m02:18:50.052491 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:18:50.052999 [info ] [MainThread]: 
[0m02:18:50.053578 [error] [MainThread]:   Database Error in model price_momentum (models\stock_metrics\price_momentum.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\lab02_pair14\models\stock_metrics\price_momentum.sql
[0m02:18:50.054125 [info ] [MainThread]: 
[0m02:18:50.054599 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m02:18:50.055615 [debug] [MainThread]: Command `dbt run` failed at 02:18:50.055500 after 6.33 seconds
[0m02:18:50.056117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5491BD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE57E9AC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE57F0BC50>]}
[0m02:18:50.056618 [debug] [MainThread]: Flushing usage events
[0m02:18:50.459541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:23.811768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A79719BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A773C6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7A1A6210>]}


============================== 02:19:23.816983 | b1c32c93-8b02-45eb-bb57-91f27fc4fba2 ==============================
[0m02:19:23.816983 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:19:23.817702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:19:24.203882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1c32c93-8b02-45eb-bb57-91f27fc4fba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7C3142B0>]}
[0m02:19:24.260931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1c32c93-8b02-45eb-bb57-91f27fc4fba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7C1E49E0>]}
[0m02:19:24.262432 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:19:24.536429 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m02:19:24.663988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:19:24.664553 [debug] [MainThread]: Partial parsing: updated file: lab02_pair14://models\stock_metrics\price_momentum.sql
[0m02:19:24.945417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1c32c93-8b02-45eb-bb57-91f27fc4fba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7C4B4650>]}
[0m02:19:24.994809 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:19:24.998327 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:19:25.022841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1c32c93-8b02-45eb-bb57-91f27fc4fba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7A1488C0>]}
[0m02:19:25.023303 [info ] [MainThread]: Found 5 models, 474 macros
[0m02:19:25.023861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c32c93-8b02-45eb-bb57-91f27fc4fba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7C2073F0>]}
[0m02:19:25.025658 [info ] [MainThread]: 
[0m02:19:25.026129 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:19:25.026566 [info ] [MainThread]: 
[0m02:19:25.027195 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:19:25.031997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m02:19:25.114200 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m02:19:25.114583 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m02:19:25.114872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:25.558210 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.443 seconds
[0m02:19:25.560938 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m02:19:25.569018 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m02:19:25.569341 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m02:19:25.569633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:25.916563 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.347 seconds
[0m02:19:25.919944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c32c93-8b02-45eb-bb57-91f27fc4fba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7C962B60>]}
[0m02:19:25.924683 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m02:19:25.925586 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m02:19:25.926680 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m02:19:25.927353 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m02:19:25.933857 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m02:19:25.934576 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m02:19:25.962844 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m02:19:25.964138 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m02:19:25.964511 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM user_db_boa.raw.stocks_data
  );
[0m02:19:25.964863 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:19:26.529790 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m02:19:26.556563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c32c93-8b02-45eb-bb57-91f27fc4fba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7C70FD10>]}
[0m02:19:26.557171 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.63s]
[0m02:19:26.557942 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m02:19:26.558700 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m02:19:26.559127 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.moving_avg .............................. [RUN]
[0m02:19:26.559679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m02:19:26.560023 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m02:19:26.562460 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m02:19:26.563085 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m02:19:26.583314 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m02:19:26.584580 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m02:19:26.584955 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        round(close, 2),
        round(AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 4 PRECEDING AND CURRENT ROW), 2) AS moving_avg_5d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m02:19:27.179420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.594 seconds
[0m02:19:27.181455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c32c93-8b02-45eb-bb57-91f27fc4fba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7CB65B20>]}
[0m02:19:27.182064 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 0.62s]
[0m02:19:27.182831 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m02:19:27.183205 [debug] [Thread-1 (]: Began running node model.lab02_pair14.price_momentum
[0m02:19:27.183717 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.price_momentum .......................... [RUN]
[0m02:19:27.184204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.moving_avg, now model.lab02_pair14.price_momentum)
[0m02:19:27.184588 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.price_momentum
[0m02:19:27.186906 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.price_momentum"
[0m02:19:27.187647 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.price_momentum
[0m02:19:27.189626 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.price_momentum"
[0m02:19:27.190787 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.price_momentum"
[0m02:19:27.191177 [debug] [Thread-1 (]: On model.lab02_pair14.price_momentum: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.price_momentum"} */
create or replace transient table USER_DB_BOA.analytics.price_momentum
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close, 5) OVER (PARTITION BY symbol ORDER BY date) AS close_5_days_ago
    FROM USER_DB_BOA.analytics.raw_stocks_data
)

SELECT
    symbol,
    date,
    round(close, 2),
    round(close_5_days_ago, 2) as close_5_days_ago,
    round(close - close_5_days_ago, 2) AS price_momentum
FROM base
WHERE close_5_days_ago IS NOT NULL
        );
[0m02:19:27.305188 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbe0cf-0305-0c98-0004-59ff002b8096
[0m02:19:27.305734 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m02:19:27.313358 [debug] [Thread-1 (]: Database Error in model price_momentum (models\stock_metrics\price_momentum.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\lab02_pair14\models\stock_metrics\price_momentum.sql
[0m02:19:27.313994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c32c93-8b02-45eb-bb57-91f27fc4fba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7CC8C370>]}
[0m02:19:27.314847 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model analytics.price_momentum ................. [[31mERROR[0m in 0.13s]
[0m02:19:27.316267 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.price_momentum
[0m02:19:27.317096 [debug] [Thread-1 (]: Began running node model.lab02_pair14.rsi
[0m02:19:27.317771 [debug] [Thread-4 (]: Marking all children of 'model.lab02_pair14.price_momentum' to be skipped because of status 'error'.  Reason: Database Error in model price_momentum (models\stock_metrics\price_momentum.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\lab02_pair14\models\stock_metrics\price_momentum.sql.
[0m02:19:27.318306 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m02:19:27.319715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.price_momentum, now model.lab02_pair14.rsi)
[0m02:19:27.320185 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.rsi
[0m02:19:27.322969 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.rsi"
[0m02:19:27.323687 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.rsi
[0m02:19:27.326685 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.rsi"
[0m02:19:27.329048 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.rsi"
[0m02:19:27.329784 [debug] [Thread-1 (]: On model.lab02_pair14.rsi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.rsi"} */
create or replace transient table USER_DB_BOA.analytics.rsi
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        CASE WHEN close - prev_close > 0 THEN close - prev_close ELSE 0 END AS gain,
        CASE WHEN close - prev_close < 0 THEN ABS(close - prev_close) ELSE 0 END AS loss
    FROM base
    WHERE prev_close IS NOT NULL
),

rsi_calc AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        AVG(loss) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM gains_losses
)

SELECT
    symbol,
    date,
    round(100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))), 2) AS rsi_14d
FROM rsi_calc
        );
[0m02:19:27.956429 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m02:19:27.958512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c32c93-8b02-45eb-bb57-91f27fc4fba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7CA3CFD0>]}
[0m02:19:27.959089 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 0.64s]
[0m02:19:27.959929 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.rsi
[0m02:19:27.960316 [debug] [Thread-1 (]: Began running node model.lab02_pair14.volatility
[0m02:19:27.960763 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.volatility .............................. [RUN]
[0m02:19:27.961367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.rsi, now model.lab02_pair14.volatility)
[0m02:19:27.961732 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.volatility
[0m02:19:27.963940 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.volatility"
[0m02:19:27.964592 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.volatility
[0m02:19:27.967074 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.volatility"
[0m02:19:27.968241 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.volatility"
[0m02:19:27.968611 [debug] [Thread-1 (]: On model.lab02_pair14.volatility: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.volatility"} */
create or replace transient table USER_DB_BOA.analytics.volatility
         as
        (WITH returns AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

daily_returns AS (
    SELECT 
        symbol,
        date,
        (close - prev_close) / prev_close AS daily_return
    FROM returns
    WHERE prev_close IS NOT NULL
)

SELECT
    symbol,
    date,
    round(STDDEV_SAMP(daily_return) OVER (
        PARTITION BY symbol ORDER BY date ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
    ), 2) AS volatility_10d
FROM daily_returns
        );
[0m02:19:28.868269 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.899 seconds
[0m02:19:28.870541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c32c93-8b02-45eb-bb57-91f27fc4fba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7CD7A900>]}
[0m02:19:28.871075 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.volatility ......................... [[32mSUCCESS 1[0m in 0.91s]
[0m02:19:28.871817 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.volatility
[0m02:19:28.872918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:19:28.873176 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m02:19:28.873431 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m02:19:28.988905 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m02:19:28.989256 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m02:19:29.125323 [debug] [MainThread]: Connection 'model.lab02_pair14.volatility' was left open.
[0m02:19:29.126233 [debug] [MainThread]: On model.lab02_pair14.volatility: Close
[0m02:19:29.232841 [info ] [MainThread]: 
[0m02:19:29.233402 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 4.21 seconds (4.21s).
[0m02:19:29.234833 [debug] [MainThread]: Command end result
[0m02:19:29.252850 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:19:29.255150 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:19:29.261005 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m02:19:29.261347 [info ] [MainThread]: 
[0m02:19:29.261875 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m02:19:29.262357 [info ] [MainThread]: 
[0m02:19:29.262856 [error] [MainThread]:   Database Error in model price_momentum (models\stock_metrics\price_momentum.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\lab02_pair14\models\stock_metrics\price_momentum.sql
[0m02:19:29.263463 [info ] [MainThread]: 
[0m02:19:29.264086 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m02:19:29.265270 [debug] [MainThread]: Command `dbt run` failed at 02:19:29.265116 after 5.67 seconds
[0m02:19:29.265691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7CCF68D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7A559D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A7A51B9B0>]}
[0m02:19:29.266044 [debug] [MainThread]: Flushing usage events
[0m02:19:29.628194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:20:43.768877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFE25DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFBF42350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFECE6210>]}


============================== 02:20:43.772873 | 7dd8fed7-bb2c-46b1-a60d-19e52de5e09f ==============================
[0m02:20:43.772873 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:20:43.773484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:20:44.202081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dd8fed7-bb2c-46b1-a60d-19e52de5e09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFFF342B0>]}
[0m02:20:44.261636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dd8fed7-bb2c-46b1-a60d-19e52de5e09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFFE049E0>]}
[0m02:20:44.262888 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:20:44.543122 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m02:20:44.671353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:20:44.671875 [debug] [MainThread]: Partial parsing: updated file: lab02_pair14://models\stock_metrics\price_momentum.sql
[0m02:20:44.953501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dd8fed7-bb2c-46b1-a60d-19e52de5e09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E810A4650>]}
[0m02:20:45.004015 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:20:45.007352 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:20:45.034694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dd8fed7-bb2c-46b1-a60d-19e52de5e09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFEC888C0>]}
[0m02:20:45.035130 [info ] [MainThread]: Found 5 models, 474 macros
[0m02:20:45.035741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd8fed7-bb2c-46b1-a60d-19e52de5e09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFFE273F0>]}
[0m02:20:45.037812 [info ] [MainThread]: 
[0m02:20:45.038303 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:20:45.038708 [info ] [MainThread]: 
[0m02:20:45.039310 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:20:45.044041 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m02:20:45.121881 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m02:20:45.122241 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m02:20:45.122530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:45.591689 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.469 seconds
[0m02:20:45.595202 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m02:20:45.605372 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m02:20:45.605920 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m02:20:45.606464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:20:45.989093 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.383 seconds
[0m02:20:45.992765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd8fed7-bb2c-46b1-a60d-19e52de5e09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E8153AB60>]}
[0m02:20:45.996988 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m02:20:45.997500 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m02:20:45.998238 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m02:20:45.998593 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m02:20:46.004221 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m02:20:46.004999 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m02:20:46.032847 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m02:20:46.034220 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m02:20:46.034857 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM user_db_boa.raw.stocks_data
  );
[0m02:20:46.035222 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:20:46.623097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m02:20:46.649529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd8fed7-bb2c-46b1-a60d-19e52de5e09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E81303D10>]}
[0m02:20:46.650408 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.65s]
[0m02:20:46.651207 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m02:20:46.652057 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m02:20:46.652548 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.moving_avg .............................. [RUN]
[0m02:20:46.653179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m02:20:46.653538 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m02:20:46.657119 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m02:20:46.657980 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m02:20:46.683791 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m02:20:46.686649 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m02:20:46.687440 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        round(close, 2),
        round(AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 4 PRECEDING AND CURRENT ROW), 2) AS moving_avg_5d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m02:20:47.433350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m02:20:47.435343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd8fed7-bb2c-46b1-a60d-19e52de5e09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E81745B20>]}
[0m02:20:47.435899 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 0.78s]
[0m02:20:47.436687 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m02:20:47.437051 [debug] [Thread-1 (]: Began running node model.lab02_pair14.price_momentum
[0m02:20:47.437457 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.price_momentum .......................... [RUN]
[0m02:20:47.438035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.moving_avg, now model.lab02_pair14.price_momentum)
[0m02:20:47.438368 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.price_momentum
[0m02:20:47.441037 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.price_momentum"
[0m02:20:47.441724 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.price_momentum
[0m02:20:47.444134 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.price_momentum"
[0m02:20:47.445223 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.price_momentum"
[0m02:20:47.445628 [debug] [Thread-1 (]: On model.lab02_pair14.price_momentum: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.price_momentum"} */
create or replace transient table USER_DB_BOA.analytics.price_momentum
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close, 5) OVER (PARTITION BY symbol ORDER BY date) AS close_5_days_ago
    FROM USER_DB_BOA.analytics.raw_stocks_data
)

SELECT
    symbol,
    date,
    round(close, 2) as close,
    round(close_5_days_ago, 2) as close_5_days_ago,
    round(close - close_5_days_ago, 2) AS price_momentum
FROM base
WHERE close_5_days_ago IS NOT NULL
        );
[0m02:20:48.112902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m02:20:48.114740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd8fed7-bb2c-46b1-a60d-19e52de5e09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E81821590>]}
[0m02:20:48.115405 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.price_momentum ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m02:20:48.116382 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.price_momentum
[0m02:20:48.116712 [debug] [Thread-1 (]: Began running node model.lab02_pair14.rsi
[0m02:20:48.117130 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m02:20:48.117801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.price_momentum, now model.lab02_pair14.rsi)
[0m02:20:48.118106 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.rsi
[0m02:20:48.120161 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.rsi"
[0m02:20:48.120885 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.rsi
[0m02:20:48.123581 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.rsi"
[0m02:20:48.125297 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.rsi"
[0m02:20:48.125909 [debug] [Thread-1 (]: On model.lab02_pair14.rsi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.rsi"} */
create or replace transient table USER_DB_BOA.analytics.rsi
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        CASE WHEN close - prev_close > 0 THEN close - prev_close ELSE 0 END AS gain,
        CASE WHEN close - prev_close < 0 THEN ABS(close - prev_close) ELSE 0 END AS loss
    FROM base
    WHERE prev_close IS NOT NULL
),

rsi_calc AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        AVG(loss) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM gains_losses
)

SELECT
    symbol,
    date,
    round(100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))), 2) AS rsi_14d
FROM rsi_calc
        );
[0m02:20:48.841857 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.715 seconds
[0m02:20:48.843623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd8fed7-bb2c-46b1-a60d-19e52de5e09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E8160F250>]}
[0m02:20:48.844124 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 0.73s]
[0m02:20:48.844908 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.rsi
[0m02:20:48.845310 [debug] [Thread-1 (]: Began running node model.lab02_pair14.volatility
[0m02:20:48.845697 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.volatility .............................. [RUN]
[0m02:20:48.846271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.rsi, now model.lab02_pair14.volatility)
[0m02:20:48.846571 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.volatility
[0m02:20:48.848445 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.volatility"
[0m02:20:48.849069 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.volatility
[0m02:20:48.851638 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.volatility"
[0m02:20:48.853242 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.volatility"
[0m02:20:48.853853 [debug] [Thread-1 (]: On model.lab02_pair14.volatility: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.volatility"} */
create or replace transient table USER_DB_BOA.analytics.volatility
         as
        (WITH returns AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

daily_returns AS (
    SELECT 
        symbol,
        date,
        (close - prev_close) / prev_close AS daily_return
    FROM returns
    WHERE prev_close IS NOT NULL
)

SELECT
    symbol,
    date,
    round(STDDEV_SAMP(daily_return) OVER (
        PARTITION BY symbol ORDER BY date ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
    ), 2) AS volatility_10d
FROM daily_returns
        );
[0m02:20:49.554884 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.700 seconds
[0m02:20:49.556781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd8fed7-bb2c-46b1-a60d-19e52de5e09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E81857620>]}
[0m02:20:49.557296 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.volatility ......................... [[32mSUCCESS 1[0m in 0.71s]
[0m02:20:49.558040 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.volatility
[0m02:20:49.559295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:20:49.559566 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m02:20:49.559832 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m02:20:49.665120 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m02:20:49.665488 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m02:20:49.767962 [debug] [MainThread]: Connection 'model.lab02_pair14.volatility' was left open.
[0m02:20:49.768304 [debug] [MainThread]: On model.lab02_pair14.volatility: Close
[0m02:20:49.876635 [info ] [MainThread]: 
[0m02:20:49.877262 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m02:20:49.878829 [debug] [MainThread]: Command end result
[0m02:20:49.899788 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:20:49.903147 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:20:49.909765 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m02:20:49.910145 [info ] [MainThread]: 
[0m02:20:49.910703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:20:49.911203 [info ] [MainThread]: 
[0m02:20:49.911709 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m02:20:49.912837 [debug] [MainThread]: Command `dbt run` succeeded at 02:20:49.912703 after 6.36 seconds
[0m02:20:49.913249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024EFECBBD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E81827C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E81824C50>]}
[0m02:20:49.913591 [debug] [MainThread]: Flushing usage events
[0m02:20:50.315739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:43:54.292886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232E740DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232E50F2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232E7E96210>]}


============================== 02:43:54.299507 | f3ff4758-d9e7-41c1-9bf1-87f04b91902c ==============================
[0m02:43:54.299507 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:43:54.300574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m02:43:54.773020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3ff4758-d9e7-41c1-9bf1-87f04b91902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232EA0743E0>]}
[0m02:43:54.829119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3ff4758-d9e7-41c1-9bf1-87f04b91902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232E9F549E0>]}
[0m02:43:54.830469 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m02:43:55.136513 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m02:43:55.287365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:43:55.287735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:43:55.313135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3ff4758-d9e7-41c1-9bf1-87f04b91902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232EA218950>]}
[0m02:43:55.344670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3ff4758-d9e7-41c1-9bf1-87f04b91902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232EA0CF980>]}
[0m02:43:55.345122 [info ] [MainThread]: Found 5 models, 474 macros
[0m02:43:55.345649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3ff4758-d9e7-41c1-9bf1-87f04b91902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232EA349C50>]}
[0m02:43:55.347606 [info ] [MainThread]: 
[0m02:43:55.348109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:43:55.348550 [info ] [MainThread]: 
[0m02:43:55.349169 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:43:55.354122 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m02:43:55.450959 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m02:43:55.451342 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m02:43:55.451681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:56.022161 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.570 seconds
[0m02:43:56.026075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3ff4758-d9e7-41c1-9bf1-87f04b91902c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232EA625640>]}
[0m02:43:56.031954 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m02:43:56.032442 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m02:43:56.032781 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m02:43:56.039259 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m02:43:56.040008 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m02:43:56.040912 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m02:43:56.041678 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m02:43:56.042301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m02:43:56.043004 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m02:43:56.045432 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m02:43:56.046092 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m02:43:56.046758 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m02:43:56.047155 [debug] [Thread-1 (]: Began running node model.lab02_pair14.price_momentum
[0m02:43:56.047621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.moving_avg, now model.lab02_pair14.price_momentum)
[0m02:43:56.047969 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.price_momentum
[0m02:43:56.049993 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.price_momentum"
[0m02:43:56.050578 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.price_momentum
[0m02:43:56.051211 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.price_momentum
[0m02:43:56.051570 [debug] [Thread-1 (]: Began running node model.lab02_pair14.rsi
[0m02:43:56.052034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.price_momentum, now model.lab02_pair14.rsi)
[0m02:43:56.052388 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.rsi
[0m02:43:56.054761 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.rsi"
[0m02:43:56.055409 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.rsi
[0m02:43:56.056075 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.rsi
[0m02:43:56.056442 [debug] [Thread-1 (]: Began running node model.lab02_pair14.volatility
[0m02:43:56.056875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.rsi, now model.lab02_pair14.volatility)
[0m02:43:56.057278 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.volatility
[0m02:43:56.059260 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.volatility"
[0m02:43:56.059840 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.volatility
[0m02:43:56.060458 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.volatility
[0m02:43:56.061385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:43:56.061664 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m02:43:56.061971 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m02:43:56.172638 [debug] [MainThread]: Connection 'model.lab02_pair14.volatility' was properly closed.
[0m02:43:56.173896 [debug] [MainThread]: Command end result
[0m02:43:56.223383 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:43:56.226726 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:43:56.232708 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m02:43:56.627022 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m02:43:56.627339 [info ] [MainThread]: Building catalog
[0m02:43:56.636142 [debug] [ThreadPool]: Acquiring new snowflake connection 'USER_DB_BOA.information_schema'
[0m02:43:56.651522 [debug] [ThreadPool]: Using snowflake connection "USER_DB_BOA.information_schema"
[0m02:43:56.652244 [debug] [ThreadPool]: On USER_DB_BOA.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "USER_DB_BOA.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from USER_DB_BOA.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'price_momentum' and upper("table_name") = upper('price_momentum')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'moving_avg' and upper("table_name") = upper('moving_avg')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'rsi' and upper("table_name") = upper('rsi')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'volatility' and upper("table_name") = upper('volatility')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'raw_stocks_data' and upper("table_name") = upper('raw_stocks_data')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from USER_DB_BOA.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'price_momentum' and upper("table_name") = upper('price_momentum')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'moving_avg' and upper("table_name") = upper('moving_avg')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'rsi' and upper("table_name") = upper('rsi')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'volatility' and upper("table_name") = upper('volatility')

                )
             or 
                (
                    
    "table_schema" ilike 'analytics' and upper("table_schema") = upper('analytics')

                    and 
    "table_name" ilike 'raw_stocks_data' and upper("table_name") = upper('raw_stocks_data')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m02:43:56.652709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:59.625630 [debug] [ThreadPool]: SQL status: SUCCESS 22 in 2.973 seconds
[0m02:43:59.648725 [debug] [MainThread]: Wrote artifact CatalogArtifact to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\catalog.json
[0m02:43:59.665793 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m02:43:59.667526 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m02:43:59.667886 [info ] [MainThread]: Catalog written to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\catalog.json
[0m02:43:59.668903 [debug] [MainThread]: Command `dbt docs generate` succeeded at 02:43:59.668787 after 5.65 seconds
[0m02:43:59.669209 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m02:43:59.669498 [debug] [MainThread]: Connection 'USER_DB_BOA.information_schema' was left open.
[0m02:43:59.669792 [debug] [MainThread]: On USER_DB_BOA.information_schema: Close
[0m02:43:59.778010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232E8143AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232EA824EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232EA824CB0>]}
[0m02:43:59.778424 [debug] [MainThread]: Flushing usage events
[0m02:44:00.159788 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:49:17.950517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA458D9BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA435B2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA46366210>]}


============================== 02:49:17.955895 | a2aa737f-4495-44c9-928e-d544a2f96cb4 ==============================
[0m02:49:17.955895 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:49:17.956580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14', 'debug': 'False', 'warn_error': 'None', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:49:17.959223 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'lab02_pair14'
[0m02:49:17.960229 [debug] [MainThread]: Command `dbt docs generate` failed at 02:49:17.960098 after 0.24 seconds
[0m02:49:17.960591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA468A4180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA46878B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA46738E20>]}
[0m02:49:17.960967 [debug] [MainThread]: Flushing usage events
[0m02:49:18.320431 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:51:15.730409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60F06DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60CD42350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60FAF6210>]}


============================== 02:51:15.734638 | 03a5e1b1-7b02-46a4-95ca-2d896f3f9901 ==============================
[0m02:51:15.734638 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:51:15.735308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:51:15.737839 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'lab02_pair14'
[0m02:51:15.738795 [debug] [MainThread]: Command `dbt docs generate` failed at 02:51:15.738658 after 0.26 seconds
[0m02:51:15.739134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B610038180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B610008B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60FEC8E20>]}
[0m02:51:15.739491 [debug] [MainThread]: Flushing usage events
[0m02:51:16.148689 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:08:49.911677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7AD8DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF78A72350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7B816210>]}


============================== 03:08:49.917510 | fb784b5e-c17d-43a8-bd16-80c482b7fa5d ==============================
[0m03:08:49.917510 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:08:49.918185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:08:49.947451 [info ] [MainThread]: dbt version: 1.9.4
[0m03:08:49.948137 [info ] [MainThread]: python version: 3.13.1
[0m03:08:49.948577 [info ] [MainThread]: python path: F:\SJSU DATA 226\Assignments\Lab_02\envLab02\Scripts\python.exe
[0m03:08:49.948984 [info ] [MainThread]: os info: Windows-11-10.0.22000-SP0
[0m03:08:50.334375 [info ] [MainThread]: Using profiles dir at C:\Users\pjdam\.dbt
[0m03:08:50.334961 [info ] [MainThread]: Using profiles.yml file at C:\Users\pjdam\.dbt\profiles.yml
[0m03:08:50.335456 [info ] [MainThread]: Using dbt_project.yml file at F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\dbt_project.yml
[0m03:08:50.336809 [info ] [MainThread]: adapter type: snowflake
[0m03:08:50.337286 [info ] [MainThread]: adapter version: 1.9.2
[0m03:08:50.437657 [info ] [MainThread]: Configuration:
[0m03:08:50.438218 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:08:50.438628 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:08:50.439018 [info ] [MainThread]: Required dependencies:
[0m03:08:50.439437 [debug] [MainThread]: Executing "git --help"
[0m03:08:50.478297 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:08:50.478803 [debug] [MainThread]: STDERR: "b''"
[0m03:08:50.479178 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:08:50.479621 [info ] [MainThread]: Connection:
[0m03:08:50.480023 [info ] [MainThread]:   account: sfedu02-ksb65579
[0m03:08:50.480445 [info ] [MainThread]:   user: BOA
[0m03:08:50.480910 [info ] [MainThread]:   database: USER_DB_BOA
[0m03:08:50.481392 [info ] [MainThread]:   warehouse: BOA_QUERY_WH
[0m03:08:50.481881 [info ] [MainThread]:   role: TRAINING_ROLE
[0m03:08:50.482471 [info ] [MainThread]:   schema: analytics
[0m03:08:50.483012 [info ] [MainThread]:   authenticator: None
[0m03:08:50.483594 [info ] [MainThread]:   oauth_client_id: None
[0m03:08:50.484063 [info ] [MainThread]:   query_tag: None
[0m03:08:50.484497 [info ] [MainThread]:   client_session_keep_alive: False
[0m03:08:50.484877 [info ] [MainThread]:   host: None
[0m03:08:50.485276 [info ] [MainThread]:   port: None
[0m03:08:50.485697 [info ] [MainThread]:   proxy_host: None
[0m03:08:50.486078 [info ] [MainThread]:   proxy_port: None
[0m03:08:50.486458 [info ] [MainThread]:   protocol: None
[0m03:08:50.486837 [info ] [MainThread]:   connect_retries: 1
[0m03:08:50.487230 [info ] [MainThread]:   connect_timeout: None
[0m03:08:50.487630 [info ] [MainThread]:   retry_on_database_errors: False
[0m03:08:50.488024 [info ] [MainThread]:   retry_all: False
[0m03:08:50.488477 [info ] [MainThread]:   insecure_mode: False
[0m03:08:50.488930 [info ] [MainThread]:   reuse_connections: True
[0m03:08:50.489711 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:08:50.827282 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m03:08:50.901753 [debug] [MainThread]: Using snowflake connection "debug"
[0m03:08:50.902176 [debug] [MainThread]: On debug: select 1 as id
[0m03:08:50.902527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:08:51.410195 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.508 seconds
[0m03:08:51.411113 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:08:51.411677 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:08:51.412745 [debug] [MainThread]: Command `dbt debug` succeeded at 03:08:51.412617 after 1.78 seconds
[0m03:08:51.413053 [debug] [MainThread]: Connection 'debug' was left open.
[0m03:08:51.413352 [debug] [MainThread]: On debug: Close
[0m03:08:51.528391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7DA3B360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7DAB3AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7D8C78A0>]}
[0m03:08:51.528842 [debug] [MainThread]: Flushing usage events
[0m03:08:51.871651 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:09:04.407083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B031679BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B02F362350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B032106210>]}


============================== 03:09:04.411438 | 17a9f897-3595-47b6-8e75-ade054aed003 ==============================
[0m03:09:04.411438 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:09:04.412092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:09:04.839632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17a9f897-3595-47b6-8e75-ade054aed003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0343342B0>]}
[0m03:09:04.895026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17a9f897-3595-47b6-8e75-ade054aed003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0342049E0>]}
[0m03:09:04.896370 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:09:05.184887 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m03:09:05.320980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m03:09:05.321478 [debug] [MainThread]: Partial parsing: added file: lab02_pair14://models\schema.yml
[0m03:09:05.598098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17a9f897-3595-47b6-8e75-ade054aed003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0344D4450>]}
[0m03:09:05.663761 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m03:09:05.667970 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m03:09:05.731674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17a9f897-3595-47b6-8e75-ade054aed003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B034722D50>]}
[0m03:09:05.732169 [info ] [MainThread]: Found 5 models, 1 test, 474 macros
[0m03:09:05.732702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17a9f897-3595-47b6-8e75-ade054aed003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0349392B0>]}
[0m03:09:05.734661 [info ] [MainThread]: 
[0m03:09:05.735184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:05.735585 [info ] [MainThread]: 
[0m03:09:05.736125 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:09:05.740668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m03:09:05.827837 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m03:09:05.828231 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m03:09:05.828606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:06.358495 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.530 seconds
[0m03:09:06.363000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17a9f897-3595-47b6-8e75-ade054aed003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B034C9E750>]}
[0m03:09:06.369329 [debug] [Thread-1 (]: Began running node test.lab02_pair14.not_null_moving_avg_moving_avg_5d.40c38a8894
[0m03:09:06.369696 [info ] [Thread-1 (]: 1 of 1 START test not_null_moving_avg_moving_avg_5d ............................ [RUN]
[0m03:09:06.370444 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.lab02_pair14.not_null_moving_avg_moving_avg_5d.40c38a8894'
[0m03:09:06.370756 [debug] [Thread-1 (]: Began compiling node test.lab02_pair14.not_null_moving_avg_moving_avg_5d.40c38a8894
[0m03:09:06.385660 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab02_pair14.not_null_moving_avg_moving_avg_5d.40c38a8894"
[0m03:09:06.387509 [debug] [Thread-1 (]: Began executing node test.lab02_pair14.not_null_moving_avg_moving_avg_5d.40c38a8894
[0m03:09:06.408349 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab02_pair14.not_null_moving_avg_moving_avg_5d.40c38a8894"
[0m03:09:06.409631 [debug] [Thread-1 (]: Using snowflake connection "test.lab02_pair14.not_null_moving_avg_moving_avg_5d.40c38a8894"
[0m03:09:06.410004 [debug] [Thread-1 (]: On test.lab02_pair14.not_null_moving_avg_moving_avg_5d.40c38a8894: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "test.lab02_pair14.not_null_moving_avg_moving_avg_5d.40c38a8894"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_avg_5d
from USER_DB_BOA.analytics.moving_avg
where moving_avg_5d is null



      
    ) dbt_internal_test
[0m03:09:06.410344 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:09:08.445594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.035 seconds
[0m03:09:08.455167 [info ] [Thread-1 (]: 1 of 1 PASS not_null_moving_avg_moving_avg_5d .................................. [[32mPASS[0m in 2.08s]
[0m03:09:08.456047 [debug] [Thread-1 (]: Finished running node test.lab02_pair14.not_null_moving_avg_moving_avg_5d.40c38a8894
[0m03:09:08.457510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:08.457793 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m03:09:08.458084 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m03:09:08.591087 [debug] [MainThread]: Connection 'test.lab02_pair14.not_null_moving_avg_moving_avg_5d.40c38a8894' was left open.
[0m03:09:08.591490 [debug] [MainThread]: On test.lab02_pair14.not_null_moving_avg_moving_avg_5d.40c38a8894: Close
[0m03:09:08.706929 [info ] [MainThread]: 
[0m03:09:08.707567 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m03:09:08.708421 [debug] [MainThread]: Command end result
[0m03:09:08.726869 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m03:09:08.729096 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m03:09:08.737816 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m03:09:08.738340 [info ] [MainThread]: 
[0m03:09:08.739063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:08.739621 [info ] [MainThread]: 
[0m03:09:08.740181 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:09:08.741364 [debug] [MainThread]: Command `dbt test` succeeded at 03:09:08.741217 after 4.55 seconds
[0m03:09:08.741753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0323B3AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B034D7CEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B034D7CF70>]}
[0m03:09:08.742129 [debug] [MainThread]: Flushing usage events
[0m03:09:09.052429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:16.332789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AC79DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AA446350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AD226210>]}


============================== 09:55:16.369184 | 376a1fcf-6896-481e-a267-c90c6f5156bb ==============================
[0m09:55:16.369184 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:55:16.370114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:55:17.721941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '376a1fcf-6896-481e-a267-c90c6f5156bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AF4F42B0>]}
[0m09:55:17.794247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '376a1fcf-6896-481e-a267-c90c6f5156bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AF3C49E0>]}
[0m09:55:17.796042 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m09:55:18.426148 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:55:20.245771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:55:20.246545 [debug] [MainThread]: Partial parsing: updated file: lab02_pair14://models\stock_metrics\moving_avg.sql
[0m09:55:20.839077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '376a1fcf-6896-481e-a267-c90c6f5156bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AF697C50>]}
[0m09:55:20.929406 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m09:55:20.953093 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m09:55:21.037640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '376a1fcf-6896-481e-a267-c90c6f5156bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AD1C88C0>]}
[0m09:55:21.038227 [info ] [MainThread]: Found 5 models, 1 test, 474 macros
[0m09:55:21.038823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '376a1fcf-6896-481e-a267-c90c6f5156bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AF44A190>]}
[0m09:55:21.040955 [info ] [MainThread]: 
[0m09:55:21.041545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:21.042109 [info ] [MainThread]: 
[0m09:55:21.042895 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:55:21.048910 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m09:55:23.826011 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m09:55:23.826494 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m09:55:23.826877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:25.461855 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.635 seconds
[0m09:55:25.466489 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m09:55:25.480451 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m09:55:25.480974 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m09:55:25.481391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:25.932434 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.451 seconds
[0m09:55:25.948357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '376a1fcf-6896-481e-a267-c90c6f5156bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AFD98390>]}
[0m09:55:25.983500 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m09:55:25.985898 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m09:55:25.988806 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m09:55:25.990514 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m09:55:26.015736 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m09:55:26.047790 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m09:55:26.085966 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m09:55:26.091818 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m09:55:26.092357 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM user_db_boa.raw.stocks_data
  );
[0m09:55:26.092823 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:55:26.862854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m09:55:26.947407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '376a1fcf-6896-481e-a267-c90c6f5156bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AFDEE690>]}
[0m09:55:26.950009 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.95s]
[0m09:55:26.953418 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m09:55:26.956503 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m09:55:26.958592 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.moving_avg .............................. [RUN]
[0m09:55:26.960798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m09:55:26.962601 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m09:55:26.974194 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m09:55:26.981058 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m09:55:27.016750 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m09:55:27.046162 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m09:55:27.046790 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        round(close, 2),
        ROUND(AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 13 PRECEDING AND CURRENT ROW), 2) AS moving_avg_14d,
        ROUND(AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 49 PRECEDING AND CURRENT ROW), 2) AS moving_avg_50d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m09:55:28.170673 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.123 seconds
[0m09:55:28.173497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '376a1fcf-6896-481e-a267-c90c6f5156bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AFEF41B0>]}
[0m09:55:28.174315 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.21s]
[0m09:55:28.175340 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m09:55:28.175866 [debug] [Thread-1 (]: Began running node model.lab02_pair14.price_momentum
[0m09:55:28.176460 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.price_momentum .......................... [RUN]
[0m09:55:28.177207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.moving_avg, now model.lab02_pair14.price_momentum)
[0m09:55:28.177698 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.price_momentum
[0m09:55:28.181163 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.price_momentum"
[0m09:55:28.184409 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.price_momentum
[0m09:55:28.187489 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.price_momentum"
[0m09:55:28.216759 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.price_momentum"
[0m09:55:28.217439 [debug] [Thread-1 (]: On model.lab02_pair14.price_momentum: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.price_momentum"} */
create or replace transient table USER_DB_BOA.analytics.price_momentum
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close, 5) OVER (PARTITION BY symbol ORDER BY date) AS close_5_days_ago
    FROM USER_DB_BOA.analytics.raw_stocks_data
)

SELECT
    symbol,
    date,
    round(close, 2) as close,
    round(close_5_days_ago, 2) as close_5_days_ago,
    round(close - close_5_days_ago, 2) AS price_momentum
FROM base
WHERE close_5_days_ago IS NOT NULL
        );
[0m09:55:29.218714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.001 seconds
[0m09:55:29.221812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '376a1fcf-6896-481e-a267-c90c6f5156bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AFF46670>]}
[0m09:55:29.222706 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.price_momentum ..................... [[32mSUCCESS 1[0m in 1.04s]
[0m09:55:29.223967 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.price_momentum
[0m09:55:29.224636 [debug] [Thread-1 (]: Began running node model.lab02_pair14.rsi
[0m09:55:29.225375 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m09:55:29.226280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.price_momentum, now model.lab02_pair14.rsi)
[0m09:55:29.226911 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.rsi
[0m09:55:29.231548 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.rsi"
[0m09:55:29.233206 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.rsi
[0m09:55:29.237017 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.rsi"
[0m09:55:29.239991 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.rsi"
[0m09:55:29.240638 [debug] [Thread-1 (]: On model.lab02_pair14.rsi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.rsi"} */
create or replace transient table USER_DB_BOA.analytics.rsi
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        CASE WHEN close - prev_close > 0 THEN close - prev_close ELSE 0 END AS gain,
        CASE WHEN close - prev_close < 0 THEN ABS(close - prev_close) ELSE 0 END AS loss
    FROM base
    WHERE prev_close IS NOT NULL
),

rsi_calc AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        AVG(loss) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM gains_losses
)

SELECT
    symbol,
    date,
    round(100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))), 2) AS rsi_14d
FROM rsi_calc
        );
[0m09:55:30.161445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.920 seconds
[0m09:55:30.164886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '376a1fcf-6896-481e-a267-c90c6f5156bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AFCD03D0>]}
[0m09:55:30.165851 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 0.94s]
[0m09:55:30.167132 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.rsi
[0m09:55:30.167924 [debug] [Thread-1 (]: Began running node model.lab02_pair14.volatility
[0m09:55:30.168761 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.volatility .............................. [RUN]
[0m09:55:30.169828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.rsi, now model.lab02_pair14.volatility)
[0m09:55:30.170684 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.volatility
[0m09:55:30.174682 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.volatility"
[0m09:55:30.175974 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.volatility
[0m09:55:30.179972 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.volatility"
[0m09:55:30.181970 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.volatility"
[0m09:55:30.182558 [debug] [Thread-1 (]: On model.lab02_pair14.volatility: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.volatility"} */
create or replace transient table USER_DB_BOA.analytics.volatility
         as
        (WITH returns AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

daily_returns AS (
    SELECT 
        symbol,
        date,
        (close - prev_close) / prev_close AS daily_return
    FROM returns
    WHERE prev_close IS NOT NULL
)

SELECT
    symbol,
    date,
    round(STDDEV_SAMP(daily_return) OVER (
        PARTITION BY symbol ORDER BY date ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
    ), 2) AS volatility_10d
FROM daily_returns
        );
[0m09:55:31.140526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.957 seconds
[0m09:55:31.143190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '376a1fcf-6896-481e-a267-c90c6f5156bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AFE60BB0>]}
[0m09:55:31.144036 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.volatility ......................... [[32mSUCCESS 1[0m in 0.97s]
[0m09:55:31.145029 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.volatility
[0m09:55:31.146592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:31.147007 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m09:55:31.147399 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m09:55:31.350639 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m09:55:31.352324 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m09:55:31.501436 [debug] [MainThread]: Connection 'model.lab02_pair14.volatility' was left open.
[0m09:55:31.502030 [debug] [MainThread]: On model.lab02_pair14.volatility: Close
[0m09:55:31.770067 [info ] [MainThread]: 
[0m09:55:31.770924 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 10.73 seconds (10.73s).
[0m09:55:31.773112 [debug] [MainThread]: Command end result
[0m09:55:31.805904 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m09:55:31.808930 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m09:55:31.817764 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m09:55:31.818330 [info ] [MainThread]: 
[0m09:55:31.819181 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:55:31.819881 [info ] [MainThread]: 
[0m09:55:31.820620 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:55:31.822112 [debug] [MainThread]: Command `dbt run` succeeded at 09:55:31.821929 after 15.82 seconds
[0m09:55:31.822644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AF88FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AFE00890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195AC8CE270>]}
[0m09:55:31.823171 [debug] [MainThread]: Flushing usage events
[0m09:55:32.368679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:15:39.406828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFEABDBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFC766350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF546210>]}


============================== 10:15:39.422596 | 17fbbe12-a82e-4b68-917b-8377a4d24eb0 ==============================
[0m10:15:39.422596 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:15:39.424321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:15:40.237246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17fbbe12-a82e-4b68-917b-8377a4d24eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E817B42B0>]}
[0m10:15:40.311709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17fbbe12-a82e-4b68-917b-8377a4d24eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E816949E0>]}
[0m10:15:40.313459 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:15:40.798445 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:15:41.064166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:15:41.064672 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:15:41.112469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17fbbe12-a82e-4b68-917b-8377a4d24eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E81954750>]}
[0m10:15:41.225980 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m10:15:41.234761 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m10:15:41.360440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17fbbe12-a82e-4b68-917b-8377a4d24eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF4E88C0>]}
[0m10:15:41.361154 [info ] [MainThread]: Found 5 models, 1 test, 474 macros
[0m10:15:41.361915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17fbbe12-a82e-4b68-917b-8377a4d24eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EFF8A1FD0>]}
[0m10:15:41.364868 [info ] [MainThread]: 
[0m10:15:41.365561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:15:41.366253 [info ] [MainThread]: 
[0m10:15:41.367143 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:15:41.374429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m10:15:41.584945 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m10:15:41.585450 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m10:15:41.585859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:42.354187 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.768 seconds
[0m10:15:42.358027 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m10:15:42.371540 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m10:15:42.372099 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m10:15:42.372622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:15:42.858028 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.485 seconds
[0m10:15:42.863608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17fbbe12-a82e-4b68-917b-8377a4d24eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E81B4FEE0>]}
[0m10:15:42.871837 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m10:15:42.872609 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m10:15:42.873528 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m10:15:42.874049 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m10:15:42.882195 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m10:15:42.910750 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m10:15:42.954518 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m10:15:42.960822 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m10:15:42.961439 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM user_db_boa.raw.stocks_data
  );
[0m10:15:42.961973 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:15:43.571164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m10:15:43.604448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17fbbe12-a82e-4b68-917b-8377a4d24eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E81A23AD0>]}
[0m10:15:43.605390 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.73s]
[0m10:15:43.606490 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m10:15:43.607555 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m10:15:43.608218 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.moving_avg .............................. [RUN]
[0m10:15:43.609071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m10:15:43.609594 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m10:15:43.613711 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m10:15:43.614872 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m10:15:43.650613 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m10:15:43.679617 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m10:15:43.680295 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        round(close, 2),
        ROUND(AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 13 PRECEDING AND CURRENT ROW), 2) AS moving_avg_14d,
        ROUND(AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 49 PRECEDING AND CURRENT ROW), 2) AS moving_avg_50d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m10:15:44.709138 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.028 seconds
[0m10:15:44.712452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17fbbe12-a82e-4b68-917b-8377a4d24eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E81EB5D30>]}
[0m10:15:44.713454 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 1.10s]
[0m10:15:44.714616 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m10:15:44.715202 [debug] [Thread-1 (]: Began running node model.lab02_pair14.price_momentum
[0m10:15:44.715913 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.price_momentum .......................... [RUN]
[0m10:15:44.716750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.moving_avg, now model.lab02_pair14.price_momentum)
[0m10:15:44.717300 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.price_momentum
[0m10:15:44.721297 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.price_momentum"
[0m10:15:44.722510 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.price_momentum
[0m10:15:44.725950 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.price_momentum"
[0m10:15:44.754391 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.price_momentum"
[0m10:15:44.755060 [debug] [Thread-1 (]: On model.lab02_pair14.price_momentum: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.price_momentum"} */
create or replace transient table USER_DB_BOA.analytics.price_momentum
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close, 5) OVER (PARTITION BY symbol ORDER BY date) AS close_5_days_ago
    FROM USER_DB_BOA.analytics.raw_stocks_data
)

SELECT
    symbol,
    date,
    round(close, 2) as close,
    round(close_5_days_ago, 2) as close_5_days_ago,
    round(close - close_5_days_ago, 2) AS price_momentum
FROM base
WHERE close_5_days_ago IS NOT NULL
        );
[0m10:15:45.673067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.917 seconds
[0m10:15:45.676195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17fbbe12-a82e-4b68-917b-8377a4d24eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82028FF0>]}
[0m10:15:45.677132 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.price_momentum ..................... [[32mSUCCESS 1[0m in 0.96s]
[0m10:15:45.678405 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.price_momentum
[0m10:15:45.679010 [debug] [Thread-1 (]: Began running node model.lab02_pair14.rsi
[0m10:15:45.679922 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m10:15:45.680847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.price_momentum, now model.lab02_pair14.rsi)
[0m10:15:45.681461 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.rsi
[0m10:15:45.685026 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.rsi"
[0m10:15:45.686623 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.rsi
[0m10:15:45.691271 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.rsi"
[0m10:15:45.694188 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.rsi"
[0m10:15:45.694949 [debug] [Thread-1 (]: On model.lab02_pair14.rsi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.rsi"} */
create or replace transient table USER_DB_BOA.analytics.rsi
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        CASE WHEN close - prev_close > 0 THEN close - prev_close ELSE 0 END AS gain,
        CASE WHEN close - prev_close < 0 THEN ABS(close - prev_close) ELSE 0 END AS loss
    FROM base
    WHERE prev_close IS NOT NULL
),

rsi_calc AS (
    SELECT
        symbol,
        date,
        AVG(gain) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain,
        AVG(loss) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss
    FROM gains_losses
)

SELECT
    symbol,
    date,
    round(100 - (100 / (1 + (avg_gain / NULLIF(avg_loss, 0)))), 2) AS rsi_14d
FROM rsi_calc
        );
[0m10:15:46.744633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.049 seconds
[0m10:15:46.747288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17fbbe12-a82e-4b68-917b-8377a4d24eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E81D90F50>]}
[0m10:15:46.748048 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 1.07s]
[0m10:15:46.749052 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.rsi
[0m10:15:46.749567 [debug] [Thread-1 (]: Began running node model.lab02_pair14.volatility
[0m10:15:46.750133 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.volatility .............................. [RUN]
[0m10:15:46.750852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.rsi, now model.lab02_pair14.volatility)
[0m10:15:46.751300 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.volatility
[0m10:15:46.754068 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.volatility"
[0m10:15:46.755264 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.volatility
[0m10:15:46.758585 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.volatility"
[0m10:15:46.786549 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.volatility"
[0m10:15:46.787261 [debug] [Thread-1 (]: On model.lab02_pair14.volatility: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.volatility"} */
create or replace transient table USER_DB_BOA.analytics.volatility
         as
        (WITH returns AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

daily_returns AS (
    SELECT 
        symbol,
        date,
        (close - prev_close) / prev_close AS daily_return
    FROM returns
    WHERE prev_close IS NOT NULL
)

SELECT
    symbol,
    date,
    round(STDDEV_SAMP(daily_return) OVER (
        PARTITION BY symbol ORDER BY date ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
    ), 2) AS volatility_10d
FROM daily_returns
        );
[0m10:15:47.508583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.721 seconds
[0m10:15:47.511702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17fbbe12-a82e-4b68-917b-8377a4d24eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E82040980>]}
[0m10:15:47.512599 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.volatility ......................... [[32mSUCCESS 1[0m in 0.76s]
[0m10:15:47.513835 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.volatility
[0m10:15:47.515580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:15:47.516067 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m10:15:47.516537 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m10:15:47.668779 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m10:15:47.669340 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m10:15:47.791349 [debug] [MainThread]: Connection 'model.lab02_pair14.volatility' was left open.
[0m10:15:47.791931 [debug] [MainThread]: On model.lab02_pair14.volatility: Close
[0m10:15:47.973911 [info ] [MainThread]: 
[0m10:15:47.974598 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m10:15:47.976551 [debug] [MainThread]: Command end result
[0m10:15:48.004699 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m10:15:48.007263 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m10:15:48.014945 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m10:15:48.015433 [info ] [MainThread]: 
[0m10:15:48.016176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:15:48.016812 [info ] [MainThread]: 
[0m10:15:48.017461 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:15:48.018808 [debug] [MainThread]: Command `dbt run` succeeded at 10:15:48.018643 after 9.04 seconds
[0m10:15:48.019258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E81662450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E81FE5CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E81FE6990>]}
[0m10:15:48.019725 [debug] [MainThread]: Flushing usage events
[0m10:15:48.587877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:18:49.228550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022932E4DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022930B22350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229338D6210>]}


============================== 10:18:49.264694 | 67391683-ded3-442b-879c-007b15a99715 ==============================
[0m10:18:49.264694 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:18:49.265570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:18:49.950407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67391683-ded3-442b-879c-007b15a99715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022935AB42B0>]}
[0m10:18:50.024106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67391683-ded3-442b-879c-007b15a99715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229359849E0>]}
[0m10:18:50.025826 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:18:50.494224 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:18:50.720774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:18:50.721473 [debug] [MainThread]: Partial parsing: updated file: lab02_pair14://models\stock_metrics\rsi.sql
[0m10:18:51.125021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67391683-ded3-442b-879c-007b15a99715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022935C56D50>]}
[0m10:18:51.221983 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m10:18:51.252160 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m10:18:51.303668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67391683-ded3-442b-879c-007b15a99715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229338788C0>]}
[0m10:18:51.304364 [info ] [MainThread]: Found 5 models, 1 test, 474 macros
[0m10:18:51.305181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67391683-ded3-442b-879c-007b15a99715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229359A66D0>]}
[0m10:18:51.308150 [info ] [MainThread]: 
[0m10:18:51.308961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:18:51.309686 [info ] [MainThread]: 
[0m10:18:51.310642 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:18:51.317746 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m10:18:51.464106 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m10:18:51.464607 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m10:18:51.465101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:52.161901 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.697 seconds
[0m10:18:52.165427 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m10:18:52.177285 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m10:18:52.177737 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m10:18:52.178210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:52.717534 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.539 seconds
[0m10:18:52.733304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67391683-ded3-442b-879c-007b15a99715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022935EA17E0>]}
[0m10:18:52.745917 [debug] [Thread-1 (]: Began running node model.lab02_pair14.raw_stocks_data
[0m10:18:52.746669 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics.raw_stocks_data .......................... [RUN]
[0m10:18:52.747651 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab02_pair14.raw_stocks_data'
[0m10:18:52.748176 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.raw_stocks_data
[0m10:18:52.756095 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.raw_stocks_data"
[0m10:18:52.757036 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.raw_stocks_data
[0m10:18:52.795151 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.raw_stocks_data"
[0m10:18:52.796373 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.raw_stocks_data"
[0m10:18:52.796850 [debug] [Thread-1 (]: On model.lab02_pair14.raw_stocks_data: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.raw_stocks_data"} */
create or replace   view USER_DB_BOA.analytics.raw_stocks_data
  
   as (
    SELECT * FROM user_db_boa.raw.stocks_data
  );
[0m10:18:52.797304 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:18:53.493786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m10:18:53.526986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67391683-ded3-442b-879c-007b15a99715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022935D23B90>]}
[0m10:18:53.527797 [info ] [Thread-1 (]: 1 of 5 OK created sql view model analytics.raw_stocks_data ..................... [[32mSUCCESS 1[0m in 0.78s]
[0m10:18:53.528855 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.raw_stocks_data
[0m10:18:53.529781 [debug] [Thread-1 (]: Began running node model.lab02_pair14.moving_avg
[0m10:18:53.530456 [info ] [Thread-1 (]: 2 of 5 START sql table model analytics.moving_avg .............................. [RUN]
[0m10:18:53.531238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.raw_stocks_data, now model.lab02_pair14.moving_avg)
[0m10:18:53.531703 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.moving_avg
[0m10:18:53.535126 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.moving_avg"
[0m10:18:53.536017 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.moving_avg
[0m10:18:53.567293 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.moving_avg"
[0m10:18:53.572783 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.moving_avg"
[0m10:18:53.573500 [debug] [Thread-1 (]: On model.lab02_pair14.moving_avg: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.moving_avg"} */
create or replace transient table USER_DB_BOA.analytics.moving_avg
         as
        (-- models/stock_metrics/moving_avg.sql
WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        ROW_NUMBER() OVER (PARTITION BY symbol ORDER BY date) AS row_num
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

moving_avg_calc AS (
    SELECT 
        symbol,
        date,
        round(close, 2),
        ROUND(AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 13 PRECEDING AND CURRENT ROW), 2) AS moving_avg_14d,
        ROUND(AVG(close) OVER (PARTITION BY symbol ORDER BY row_num ROWS BETWEEN 49 PRECEDING AND CURRENT ROW), 2) AS moving_avg_50d
    FROM base
)

SELECT * FROM moving_avg_calc
        );
[0m10:18:54.310614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m10:18:54.313907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67391683-ded3-442b-879c-007b15a99715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293620AC50>]}
[0m10:18:54.314778 [info ] [Thread-1 (]: 2 of 5 OK created sql table model analytics.moving_avg ......................... [[32mSUCCESS 1[0m in 0.78s]
[0m10:18:54.315953 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.moving_avg
[0m10:18:54.316534 [debug] [Thread-1 (]: Began running node model.lab02_pair14.price_momentum
[0m10:18:54.317172 [info ] [Thread-1 (]: 3 of 5 START sql table model analytics.price_momentum .......................... [RUN]
[0m10:18:54.318026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.moving_avg, now model.lab02_pair14.price_momentum)
[0m10:18:54.318571 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.price_momentum
[0m10:18:54.322146 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.price_momentum"
[0m10:18:54.323156 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.price_momentum
[0m10:18:54.326772 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.price_momentum"
[0m10:18:54.328694 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.price_momentum"
[0m10:18:54.329314 [debug] [Thread-1 (]: On model.lab02_pair14.price_momentum: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.price_momentum"} */
create or replace transient table USER_DB_BOA.analytics.price_momentum
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close, 5) OVER (PARTITION BY symbol ORDER BY date) AS close_5_days_ago
    FROM USER_DB_BOA.analytics.raw_stocks_data
)

SELECT
    symbol,
    date,
    round(close, 2) as close,
    round(close_5_days_ago, 2) as close_5_days_ago,
    round(close - close_5_days_ago, 2) AS price_momentum
FROM base
WHERE close_5_days_ago IS NOT NULL
        );
[0m10:18:55.233360 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.903 seconds
[0m10:18:55.238851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67391683-ded3-442b-879c-007b15a99715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002293641C0F0>]}
[0m10:18:55.241094 [info ] [Thread-1 (]: 3 of 5 OK created sql table model analytics.price_momentum ..................... [[32mSUCCESS 1[0m in 0.92s]
[0m10:18:55.242806 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.price_momentum
[0m10:18:55.243811 [debug] [Thread-1 (]: Began running node model.lab02_pair14.rsi
[0m10:18:55.245025 [info ] [Thread-1 (]: 4 of 5 START sql table model analytics.rsi ..................................... [RUN]
[0m10:18:55.246320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.price_momentum, now model.lab02_pair14.rsi)
[0m10:18:55.246998 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.rsi
[0m10:18:55.253567 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.rsi"
[0m10:18:55.254945 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.rsi
[0m10:18:55.260711 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.rsi"
[0m10:18:55.264861 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.rsi"
[0m10:18:55.266251 [debug] [Thread-1 (]: On model.lab02_pair14.rsi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.rsi"} */
create or replace transient table USER_DB_BOA.analytics.rsi
         as
        (WITH base AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

gains_losses AS (
    SELECT
        symbol,
        date,
        CASE WHEN close - prev_close > 0 THEN close - prev_close ELSE 0 END AS gain,
        CASE WHEN close - prev_close < 0 THEN ABS(close - prev_close) ELSE 0 END AS loss
    FROM base
    WHERE prev_close IS NOT NULL
),

rsi_calc AS (
    SELECT
        symbol,
        date,
        -- 14-day moving averages
        AVG(gain) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_gain_14d,
        AVG(loss) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
        ) AS avg_loss_14d,

        -- 50-day moving averages
        AVG(gain) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS avg_gain_50d,
        AVG(loss) OVER (
            PARTITION BY symbol ORDER BY date ROWS BETWEEN 49 PRECEDING AND CURRENT ROW
        ) AS avg_loss_50d
    FROM gains_losses
)

SELECT
    symbol,
    date,
    ROUND(100 - (100 / (1 + (avg_gain_14d / NULLIF(avg_loss_14d, 0)))), 2) AS rsi_14d,
    ROUND(100 - (100 / (1 + (avg_gain_50d / NULLIF(avg_loss_50d, 0)))), 2) AS rsi_50d
FROM rsi_calc
        );
[0m10:18:56.087067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.820 seconds
[0m10:18:56.090500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67391683-ded3-442b-879c-007b15a99715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229361824D0>]}
[0m10:18:56.091484 [info ] [Thread-1 (]: 4 of 5 OK created sql table model analytics.rsi ................................ [[32mSUCCESS 1[0m in 0.84s]
[0m10:18:56.092726 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.rsi
[0m10:18:56.093323 [debug] [Thread-1 (]: Began running node model.lab02_pair14.volatility
[0m10:18:56.093996 [info ] [Thread-1 (]: 5 of 5 START sql table model analytics.volatility .............................. [RUN]
[0m10:18:56.094905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab02_pair14.rsi, now model.lab02_pair14.volatility)
[0m10:18:56.095457 [debug] [Thread-1 (]: Began compiling node model.lab02_pair14.volatility
[0m10:18:56.098938 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab02_pair14.volatility"
[0m10:18:56.100020 [debug] [Thread-1 (]: Began executing node model.lab02_pair14.volatility
[0m10:18:56.103888 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab02_pair14.volatility"
[0m10:18:56.105876 [debug] [Thread-1 (]: Using snowflake connection "model.lab02_pair14.volatility"
[0m10:18:56.106628 [debug] [Thread-1 (]: On model.lab02_pair14.volatility: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "model.lab02_pair14.volatility"} */
create or replace transient table USER_DB_BOA.analytics.volatility
         as
        (WITH returns AS (
    SELECT 
        symbol,
        date,
        close,
        LAG(close) OVER (PARTITION BY symbol ORDER BY date) AS prev_close
    FROM USER_DB_BOA.analytics.raw_stocks_data
),

daily_returns AS (
    SELECT 
        symbol,
        date,
        (close - prev_close) / prev_close AS daily_return
    FROM returns
    WHERE prev_close IS NOT NULL
)

SELECT
    symbol,
    date,
    round(STDDEV_SAMP(daily_return) OVER (
        PARTITION BY symbol ORDER BY date ROWS BETWEEN 9 PRECEDING AND CURRENT ROW
    ), 2) AS volatility_10d
FROM daily_returns
        );
[0m10:18:56.884555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.777 seconds
[0m10:18:56.887448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67391683-ded3-442b-879c-007b15a99715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022936302200>]}
[0m10:18:56.888267 [info ] [Thread-1 (]: 5 of 5 OK created sql table model analytics.volatility ......................... [[32mSUCCESS 1[0m in 0.79s]
[0m10:18:56.889394 [debug] [Thread-1 (]: Finished running node model.lab02_pair14.volatility
[0m10:18:56.890999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:56.891426 [debug] [MainThread]: Connection 'list_USER_DB_BOA' was left open.
[0m10:18:56.891848 [debug] [MainThread]: On list_USER_DB_BOA: Close
[0m10:18:57.023762 [debug] [MainThread]: Connection 'list_USER_DB_BOA_analytics' was left open.
[0m10:18:57.024269 [debug] [MainThread]: On list_USER_DB_BOA_analytics: Close
[0m10:18:57.203907 [debug] [MainThread]: Connection 'model.lab02_pair14.volatility' was left open.
[0m10:18:57.204387 [debug] [MainThread]: On model.lab02_pair14.volatility: Close
[0m10:18:57.329438 [info ] [MainThread]: 
[0m10:18:57.330309 [info ] [MainThread]: Finished running 4 table models, 1 view model in 0 hours 0 minutes and 6.02 seconds (6.02s).
[0m10:18:57.332576 [debug] [MainThread]: Command end result
[0m10:18:57.362763 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m10:18:57.365630 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m10:18:57.374647 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m10:18:57.375200 [info ] [MainThread]: 
[0m10:18:57.376036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:18:57.376769 [info ] [MainThread]: 
[0m10:18:57.377538 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:18:57.379013 [debug] [MainThread]: Command `dbt run` succeeded at 10:18:57.378814 after 8.46 seconds
[0m10:18:57.379558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022930DDB9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022933288770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229363DE090>]}
[0m10:18:57.380115 [debug] [MainThread]: Flushing usage events
[0m10:18:57.894627 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:13.746576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B3F509BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B3D1E2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B3FF96210>]}


============================== 11:38:13.781208 | 57858bac-e5b5-4723-9da5-15df4af601bb ==============================
[0m11:38:13.781208 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:38:13.782122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:38:14.648460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57858bac-e5b5-4723-9da5-15df4af601bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B421242B0>]}
[0m11:38:14.726093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57858bac-e5b5-4723-9da5-15df4af601bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B420049E0>]}
[0m11:38:14.728028 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:38:15.176543 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:38:15.431527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:38:15.432112 [debug] [MainThread]: Partial parsing: added file: lab02_pair14://snapshots\stock_snapshot.sql
[0m11:38:15.767910 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.lab02_pair14.stock_snapshot' (snapshots\stock_snapshot.sql) depends on a node named 'raw_stock_data' which was not found
[0m11:38:15.769408 [debug] [MainThread]: Command `dbt snapshot` failed at 11:38:15.769238 after 2.31 seconds
[0m11:38:15.769909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B422C4750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B422C5F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B4224A120>]}
[0m11:38:15.770366 [debug] [MainThread]: Flushing usage events
[0m11:38:16.249718 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:55.644232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029327BF9BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293258A6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029328686210>]}


============================== 11:38:55.649876 | 24c89e92-94f9-4878-bd6e-c69985956151 ==============================
[0m11:38:55.649876 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:38:55.650841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'F:\\SJSU DATA 226\\Assignments\\Lab_02\\lab02_pair14\\logs', 'profiles_dir': 'C:\\Users\\pjdam\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:38:56.186909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24c89e92-94f9-4878-bd6e-c69985956151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002932A7F42B0>]}
[0m11:38:56.253102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24c89e92-94f9-4878-bd6e-c69985956151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002932A6C49E0>]}
[0m11:38:56.254568 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:38:56.584526 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:38:56.754031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:38:56.754637 [debug] [MainThread]: Partial parsing: added file: lab02_pair14://snapshots\stock_snapshot.sql
[0m11:38:57.178473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24c89e92-94f9-4878-bd6e-c69985956151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002932A996E50>]}
[0m11:38:57.295653 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m11:38:57.327264 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m11:38:57.383407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24c89e92-94f9-4878-bd6e-c69985956151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293286288C0>]}
[0m11:38:57.383952 [info ] [MainThread]: Found 5 models, 1 test, 1 snapshot, 474 macros
[0m11:38:57.384639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24c89e92-94f9-4878-bd6e-c69985956151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002932ABB5FD0>]}
[0m11:38:57.387085 [info ] [MainThread]: 
[0m11:38:57.387746 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:57.388381 [info ] [MainThread]: 
[0m11:38:57.389175 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:38:57.390362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA'
[0m11:38:57.587809 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA"
[0m11:38:57.588286 [debug] [ThreadPool]: On list_USER_DB_BOA: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA"} */
show terse schemas in database USER_DB_BOA
    limit 10000
[0m11:38:57.588672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:58.233692 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.645 seconds
[0m11:38:58.236002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA, now create_USER_DB_BOA_snapshots)
[0m11:38:58.262860 [debug] [ThreadPool]: Creating schema "database: "USER_DB_BOA"
schema: "snapshots"
"
[0m11:38:58.267619 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_BOA_snapshots"
[0m11:38:58.268013 [debug] [ThreadPool]: On create_USER_DB_BOA_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "create_USER_DB_BOA_snapshots"} */
create schema if not exists USER_DB_BOA.snapshots
[0m11:38:58.369109 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m11:38:58.375295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_BOA_analytics'
[0m11:38:58.389128 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_analytics"
[0m11:38:58.389561 [debug] [ThreadPool]: On list_USER_DB_BOA_analytics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_analytics"} */
show objects in USER_DB_BOA.analytics limit 10000;
[0m11:38:58.389927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:58.847610 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.458 seconds
[0m11:38:58.849941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_BOA_analytics, now list_USER_DB_BOA_snapshots)
[0m11:38:58.851937 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_BOA_snapshots"
[0m11:38:58.852313 [debug] [ThreadPool]: On list_USER_DB_BOA_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "connection_name": "list_USER_DB_BOA_snapshots"} */
show objects in USER_DB_BOA.snapshots limit 10000;
[0m11:38:58.969295 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.117 seconds
[0m11:38:58.972774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24c89e92-94f9-4878-bd6e-c69985956151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002932ABD3AD0>]}
[0m11:38:58.986376 [debug] [Thread-1 (]: Began running node snapshot.lab02_pair14.stock_snapshot
[0m11:38:58.987541 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.stock_snapshot ................................. [RUN]
[0m11:38:58.989240 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.lab02_pair14.stock_snapshot'
[0m11:38:58.990199 [debug] [Thread-1 (]: Began compiling node snapshot.lab02_pair14.stock_snapshot
[0m11:38:59.009091 [debug] [Thread-1 (]: Began executing node snapshot.lab02_pair14.stock_snapshot
[0m11:38:59.144253 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab02_pair14.stock_snapshot"
[0m11:38:59.144829 [debug] [Thread-1 (]: On snapshot.lab02_pair14.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "snapshot.lab02_pair14.stock_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "snapshot.lab02_pair14.stock_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol || date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        


select * from USER_DB_BOA.analytics.raw_stocks_data

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m11:38:59.145401 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:38:59.791205 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.646 seconds
[0m11:38:59.797620 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab02_pair14.stock_snapshot"
[0m11:38:59.798397 [debug] [Thread-1 (]: On snapshot.lab02_pair14.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "snapshot.lab02_pair14.stock_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "snapshot.lab02_pair14.stock_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m11:38:59.872299 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.073 seconds
[0m11:38:59.873857 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab02_pair14.stock_snapshot"
[0m11:38:59.903188 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab02_pair14.stock_snapshot"
[0m11:38:59.904007 [debug] [Thread-1 (]: On snapshot.lab02_pair14.stock_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "lab02_pair14", "target_name": "dev", "node_id": "snapshot.lab02_pair14.stock_snapshot"} */
create or replace transient table USER_DB_BOA.snapshots.stock_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(symbol || date as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        


select * from USER_DB_BOA.analytics.raw_stocks_data

    ) sbq



        );
[0m11:39:00.895730 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.991 seconds
[0m11:39:00.935843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24c89e92-94f9-4878-bd6e-c69985956151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002932B04E2D0>]}
[0m11:39:00.936929 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.stock_snapshot ................................. [[32mSUCCESS 1[0m in 1.93s]
[0m11:39:00.938011 [debug] [Thread-1 (]: Finished running node snapshot.lab02_pair14.stock_snapshot
[0m11:39:00.939512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:00.939935 [debug] [MainThread]: Connection 'create_USER_DB_BOA_snapshots' was left open.
[0m11:39:00.940322 [debug] [MainThread]: On create_USER_DB_BOA_snapshots: Close
[0m11:39:01.054354 [debug] [MainThread]: Connection 'list_USER_DB_BOA_snapshots' was left open.
[0m11:39:01.054781 [debug] [MainThread]: On list_USER_DB_BOA_snapshots: Close
[0m11:39:01.203140 [debug] [MainThread]: Connection 'snapshot.lab02_pair14.stock_snapshot' was left open.
[0m11:39:01.203570 [debug] [MainThread]: On snapshot.lab02_pair14.stock_snapshot: Close
[0m11:39:01.305457 [info ] [MainThread]: 
[0m11:39:01.306156 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m11:39:01.307095 [debug] [MainThread]: Command end result
[0m11:39:01.330637 [debug] [MainThread]: Wrote artifact WritableManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\manifest.json
[0m11:39:01.333225 [debug] [MainThread]: Wrote artifact SemanticManifest to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\semantic_manifest.json
[0m11:39:01.341155 [debug] [MainThread]: Wrote artifact RunExecutionResult to F:\SJSU DATA 226\Assignments\Lab_02\lab02_pair14\target\run_results.json
[0m11:39:01.341693 [info ] [MainThread]: 
[0m11:39:01.342585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:39:01.343436 [info ] [MainThread]: 
[0m11:39:01.344126 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:39:01.345494 [debug] [MainThread]: Command `dbt snapshot` succeeded at 11:39:01.345330 after 5.96 seconds
[0m11:39:01.345989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002932ACD49F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002932B117930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002932B1158B0>]}
[0m11:39:01.346479 [debug] [MainThread]: Flushing usage events
[0m11:39:01.713944 [debug] [MainThread]: An error was encountered while trying to flush usage events
